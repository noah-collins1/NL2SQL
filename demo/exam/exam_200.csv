qid,difficulty,question,evidence,gold_sql,expected_tables,expected_columns,tags
Q0001,moderate,Top expense categories for 2022.,Use project_expenses.category and amount.,"  SELECT category, SUM(amount) AS total
  FROM div_01.project_expenses
  WHERE EXTRACT(YEAR FROM expense_date) = 2022
  GROUP BY category
  ORDER BY total DESC;",project_expenses,"project_expenses.category,project_expenses.amount,project_expenses.expense_date",projects
Q0002,simple,Show onboarding tasks overdue as of today.,Overdue if status not done and due_date < today.,"  SELECT task_id, employee_id, task_name, due_date, status
  FROM div_01.hr_onboarding_tasks
  WHERE status <> 'done'
    AND due_date < CURRENT_DATE;",hr_onboarding_tasks,"hr_onboarding_tasks.status,hr_onboarding_tasks.due_date",hr
Q0003,simple,Primary contacts for customers in East region.,Region is on sales_regions; join customers -> sales_territories -> sales_regions.,"  SELECT c.name AS customer, cc.name AS contact, cc.email
  FROM div_01.customers c
  JOIN div_01.sales_territories st ON st.assigned_rep_id = c.customer_id
  JOIN div_01.sales_regions sr ON sr.region_id = st.region_id
  JOIN div_01.customer_contacts cc ON cc.customer_id = c.customer_id
  WHERE cc.is_primary = TRUE
    AND sr.name = 'East';","customers,sales_territories,sales_regions,customer_contacts","customer_contacts.is_primary,sales_regions.name",sales
Q0004,moderate,Top 10 customers by total sales amount in 2022?,Use order date; 'total sales' = sum(order_lines.quantity * order_lines.unit_price).,"  SELECT c.name, SUM(ol.quantity * ol.unit_price) AS total_sales
  FROM div_01.sales_orders so
  JOIN div_01.order_lines ol ON ol.order_id = so.order_id
  JOIN div_01.customers c ON c.customer_id = so.customer_id
  WHERE EXTRACT(YEAR FROM so.order_date) = 2022
  GROUP BY c.name
  ORDER BY total_sales DESC
  LIMIT 10;","sales_orders,order_lines,customers","sales_orders.order_date,order_lines.quantity,order_lines.unit_price,customers.name","sales,top_n,aggregation"
Q0005,challenging,Average days from RFQ to vendor response for 2022.,Join procurement_rfqs to procurement_rfq_responses.,"  SELECT ROUND(AVG(r.response_date - q.rfq_date), 2) AS avg_days
  FROM div_01.procurement_rfqs q
  JOIN div_01.procurement_rfq_responses r ON r.rfq_id = q.rfq_id
  WHERE EXTRACT(YEAR FROM q.rfq_date) = 2022;","procurement_rfqs,procurement_rfq_responses","procurement_rfqs.rfq_date,procurement_rfq_responses.response_date","procurement,time"
Q0006,moderate,Open opportunities by stage for 2024.,Join sales_opportunities to opportunity_stages.,"  SELECT os.name, COUNT(*) AS opportunity_count
  FROM div_01.sales_opportunities so
  JOIN div_01.opportunity_stages os ON os.stage_id = so.stage_id
  WHERE EXTRACT(YEAR FROM so.close_date) = 2024
  GROUP BY os.name;","sales_opportunities,opportunity_stages","sales_opportunities.close_date,opportunity_stages.name",sales
Q0007,moderate,Count of open customer service cases by priority.,Use cust_srv_case; open/pending are not closed.,"  SELECT priority, COUNT(*) AS case_count
  FROM div_01.cust_srv_case
  WHERE status IN ('open','pending')
  GROUP BY priority;",cust_srv_case,"cust_srv_case.status,cust_srv_case.priority",support
Q0008,moderate,Average allocation percent by project in 2021.,Use project_resources.allocation_percent.,"  SELECT p.name, ROUND(AVG(pr.allocation_percent), 2) AS avg_alloc
  FROM div_01.project_resources pr
  JOIN div_01.projects p ON p.project_id = pr.project_id
  WHERE EXTRACT(YEAR FROM p.start_date) = 2021
  GROUP BY p.name;","project_resources,projects","project_resources.allocation_percent,projects.start_date",projects
Q0009,moderate,Count of open customer service cases by priority.,Use cust_srv_case; open/pending are not closed.,"  SELECT priority, COUNT(*) AS case_count
  FROM div_01.cust_srv_case
  WHERE status IN ('open','pending')
  GROUP BY priority;",cust_srv_case,"cust_srv_case.status,cust_srv_case.priority",support
Q0010,moderate,Warehouse locations with low capacity (< 250).,Use warehouse_locations.capacity.,"  SELECT location_id, warehouse_id, aisle, rack, bin, capacity
  FROM div_01.warehouse_locations
  WHERE capacity < 250;",warehouse_locations,warehouse_locations.capacity,inventory
Q0011,moderate,Top 10 customers by total sales amount in 2023?,Use order date; 'total sales' = sum(order_lines.quantity * order_lines.unit_price).,"  SELECT c.name, SUM(ol.quantity * ol.unit_price) AS total_sales
  FROM div_01.sales_orders so
  JOIN div_01.order_lines ol ON ol.order_id = so.order_id
  JOIN div_01.customers c ON c.customer_id = so.customer_id
  WHERE EXTRACT(YEAR FROM so.order_date) = 2023
  GROUP BY c.name
  ORDER BY total_sales DESC
  LIMIT 10;","sales_orders,order_lines,customers","sales_orders.order_date,order_lines.quantity,order_lines.unit_price,customers.name","sales,top_n,aggregation"
Q0012,simple,List inactive vendors.,Use vendors.is_active.,"  SELECT vendor_id, name
  FROM div_01.vendors
  WHERE is_active = FALSE;",vendors,vendors.is_active,procurement
Q0013,challenging,Departments where actual expenses exceed budget in 2022.,Compare project_expenses vs budgets by department.,"  SELECT d.name, b.total_amount, COALESCE(SUM(pe.amount),0) AS actual_spend
  FROM div_01.budgets b
  JOIN div_01.departments d ON d.department_id = b.department_id
  LEFT JOIN div_01.project_expenses pe ON pe.project_id IS NOT NULL
  WHERE EXTRACT(YEAR FROM b.created_at) = 2022
  GROUP BY d.name, b.total_amount
  HAVING COALESCE(SUM(pe.amount),0) > b.total_amount;","budgets,budget_lines,project_expenses,departments","budgets.total_amount,project_expenses.amount","finance,projects"
Q0014,challenging,Average days between PO order date and goods receipt for each vendor in 2021.,Join purchase_orders -> goods_receipts -> vendors.,"  SELECT v.name, ROUND(AVG(gr.receipt_date - po.order_date), 2) AS avg_days
  FROM div_01.purchase_orders po
  JOIN div_01.goods_receipts gr ON gr.po_id = po.po_id
  JOIN div_01.vendors v ON v.vendor_id = po.vendor_id
  WHERE EXTRACT(YEAR FROM po.order_date) = 2021
  GROUP BY v.name
  ORDER BY avg_days;","purchase_orders,goods_receipts,vendors","purchase_orders.order_date,goods_receipts.receipt_date,vendors.name",procurement
Q0015,moderate,Assets transferred between locations in 2021.,Use asset_transfers.transfer_date.,"  SELECT transfer_id, asset_id, from_location_id, to_location_id, transfer_date
  FROM div_01.asset_transfers
  WHERE EXTRACT(YEAR FROM transfer_date) = 2021;",asset_transfers,asset_transfers.transfer_date,assets
Q0016,simple,List bank accounts with balance under 500.,Use bank_accounts.balance.,"  SELECT bank_account_id, account_number, bank_name, balance
  FROM div_01.bank_accounts
  WHERE balance < 500;",bank_accounts,bank_accounts.balance,finance
Q0017,moderate,Approval rate of purchase orders in 2023.,Use procurement_po_approvals; approved vs rejected.,"  SELECT
    ROUND(100.0 * SUM(CASE WHEN status = 'approved' THEN 1 ELSE 0 END) / COUNT(*), 2) AS approval_pct
  FROM div_01.procurement_po_approvals
  WHERE EXTRACT(YEAR FROM approval_date) = 2023;",procurement_po_approvals,"procurement_po_approvals.status,procurement_po_approvals.approval_date",procurement
Q0018,moderate,Open opportunities by stage for 2024.,Join sales_opportunities to opportunity_stages.,"  SELECT os.name, COUNT(*) AS opportunity_count
  FROM div_01.sales_opportunities so
  JOIN div_01.opportunity_stages os ON os.stage_id = so.stage_id
  WHERE EXTRACT(YEAR FROM so.close_date) = 2024
  GROUP BY os.name;","sales_opportunities,opportunity_stages","sales_opportunities.close_date,opportunity_stages.name",sales
Q0019,moderate,Average allocation percent by project in 2021.,Use project_resources.allocation_percent.,"  SELECT p.name, ROUND(AVG(pr.allocation_percent), 2) AS avg_alloc
  FROM div_01.project_resources pr
  JOIN div_01.projects p ON p.project_id = pr.project_id
  WHERE EXTRACT(YEAR FROM p.start_date) = 2021
  GROUP BY p.name;","project_resources,projects","project_resources.allocation_percent,projects.start_date",projects
Q0020,moderate,Average days between vendor invoice date and due date by vendor.,Use vendor_invoices.invoice_date and due_date.,"  SELECT v.name, ROUND(AVG(vi.due_date - vi.invoice_date), 2) AS avg_days
  FROM div_01.vendor_invoices vi
  JOIN div_01.vendors v ON v.vendor_id = vi.vendor_id
  GROUP BY v.name;","vendor_invoices,vendors","vendor_invoices.invoice_date,vendor_invoices.due_date",procurement
Q0021,simple,Primary contacts for customers in West region.,Region is on sales_regions; join customers -> sales_territories -> sales_regions.,"  SELECT c.name AS customer, cc.name AS contact, cc.email
  FROM div_01.customers c
  JOIN div_01.sales_territories st ON st.assigned_rep_id = c.customer_id
  JOIN div_01.sales_regions sr ON sr.region_id = st.region_id
  JOIN div_01.customer_contacts cc ON cc.customer_id = c.customer_id
  WHERE cc.is_primary = TRUE
    AND sr.name = 'West';","customers,sales_territories,sales_regions,customer_contacts","customer_contacts.is_primary,sales_regions.name",sales
Q0022,simple,List inactive vendors.,Use vendors.is_active.,"  SELECT vendor_id, name
  FROM div_01.vendors
  WHERE is_active = FALSE;",vendors,vendors.is_active,procurement
Q0023,moderate,Assets transferred between locations in 2024.,Use asset_transfers.transfer_date.,"  SELECT transfer_id, asset_id, from_location_id, to_location_id, transfer_date
  FROM div_01.asset_transfers
  WHERE EXTRACT(YEAR FROM transfer_date) = 2024;",asset_transfers,asset_transfers.transfer_date,assets
Q0024,moderate,Training completion rate by course for 2024.,Use employee_training.completion_date.,"  SELECT c.name, COUNT(*) AS completions
  FROM div_01.employee_training et
  JOIN div_01.training_courses c ON c.course_id = et.course_id
  WHERE EXTRACT(YEAR FROM et.completion_date) = 2024
  GROUP BY c.name
  ORDER BY completions DESC;","training_courses,employee_training",employee_training.completion_date,"hr,training"
Q0025,moderate,Top 5 vendors by total spend in 2023.,Use purchase_orders.total and vendor names.,"  SELECT v.name, SUM(po.total) AS total_spend
  FROM div_01.purchase_orders po
  JOIN div_01.vendors v ON v.vendor_id = po.vendor_id
  WHERE EXTRACT(YEAR FROM po.order_date) = 2023
  GROUP BY v.name
  ORDER BY total_spend DESC
  LIMIT 5;","purchase_orders,vendors","purchase_orders.total,purchase_orders.order_date,vendors.name",procurement
Q0026,moderate,QC failure rate for inventory lots in 2024.,Fail results have result = 'fail'.,"  SELECT
    ROUND(100.0 * SUM(CASE WHEN qi.result = 'fail' THEN 1 ELSE 0 END) / COUNT(*), 2) AS fail_pct
  FROM div_01.inventory_qc_inspections qi
  WHERE EXTRACT(YEAR FROM qi.inspection_date) = 2024;","inventory_qc_inspections,inventory_lots","inventory_qc_inspections.result,inventory_qc_inspections.inspection_date","inventory,qc"
Q0027,moderate,Benefit election count by coverage level in 2023.,Use hr_benefit_elections.election_date.,"  SELECT coverage_level, COUNT(*) AS elections
  FROM div_01.hr_benefit_elections
  WHERE EXTRACT(YEAR FROM election_date) = 2023
  GROUP BY coverage_level;",hr_benefit_elections,"hr_benefit_elections.coverage_level,hr_benefit_elections.election_date","hr,benefits"
Q0028,challenging,Average days from requisition to PO for 2022.,Join purchase_requisitions to purchase_orders by requested_by (approx).,"  SELECT ROUND(AVG(po.order_date - pr.request_date), 2) AS avg_days
  FROM div_01.purchase_requisitions pr
  JOIN div_01.purchase_orders po ON po.created_by = pr.requested_by
  WHERE EXTRACT(YEAR FROM pr.request_date) = 2022;","purchase_requisitions,purchase_orders","purchase_requisitions.request_date,purchase_orders.order_date",procurement
Q0029,challenging,Average days from RFQ to vendor response for 2023.,Join procurement_rfqs to procurement_rfq_responses.,"  SELECT ROUND(AVG(r.response_date - q.rfq_date), 2) AS avg_days
  FROM div_01.procurement_rfqs q
  JOIN div_01.procurement_rfq_responses r ON r.rfq_id = q.rfq_id
  WHERE EXTRACT(YEAR FROM q.rfq_date) = 2023;","procurement_rfqs,procurement_rfq_responses","procurement_rfqs.rfq_date,procurement_rfq_responses.response_date","procurement,time"
Q0030,challenging,Average time to close support cases in 2021.,Closed cases have status = 'closed'; use opened_at vs updated_at.,"  SELECT ROUND(AVG(updated_at - opened_at), 2) AS avg_close_time
  FROM div_01.cust_srv_case
  WHERE status = 'closed'
    AND EXTRACT(YEAR FROM opened_at) = 2021;",cust_srv_case,"cust_srv_case.opened_at,cust_srv_case.updated_at",support
Q0031,moderate,Top expense categories for 2024.,Use project_expenses.category and amount.,"  SELECT category, SUM(amount) AS total
  FROM div_01.project_expenses
  WHERE EXTRACT(YEAR FROM expense_date) = 2024
  GROUP BY category
  ORDER BY total DESC;",project_expenses,"project_expenses.category,project_expenses.amount,project_expenses.expense_date",projects
Q0032,simple,Show onboarding tasks overdue as of today.,Overdue if status not done and due_date < today.,"  SELECT task_id, employee_id, task_name, due_date, status
  FROM div_01.hr_onboarding_tasks
  WHERE status <> 'done'
    AND due_date < CURRENT_DATE;",hr_onboarding_tasks,"hr_onboarding_tasks.status,hr_onboarding_tasks.due_date",hr
Q0033,moderate,Sales orders shipped after ship_date in 2023.,Use sales_orders.ship_date and order_date; assume ship_date is planned date.,"  SELECT order_id, customer_id, order_date, ship_date
  FROM div_01.sales_orders
  WHERE ship_date IS NOT NULL
    AND ship_date > order_date
    AND EXTRACT(YEAR FROM order_date) = 2023;",sales_orders,"sales_orders.ship_date,sales_orders.order_date",sales
Q0034,moderate,Average allocation percent by project in 2021.,Use project_resources.allocation_percent.,"  SELECT p.name, ROUND(AVG(pr.allocation_percent), 2) AS avg_alloc
  FROM div_01.project_resources pr
  JOIN div_01.projects p ON p.project_id = pr.project_id
  WHERE EXTRACT(YEAR FROM p.start_date) = 2021
  GROUP BY p.name;","project_resources,projects","project_resources.allocation_percent,projects.start_date",projects
Q0035,challenging,Employee utilization rate = hours logged / 40 by week in 2024.,Use timesheet_entries.hours.,"  SELECT e.employee_id, DATE_TRUNC('week', t.week_start_date) AS week_start,
         ROUND(SUM(te.hours) / 40.0, 2) AS utilization
  FROM div_01.timesheets t
  JOIN div_01.timesheet_entries te ON te.timesheet_id = t.timesheet_id
  JOIN div_01.employees e ON e.employee_id = t.employee_id
  WHERE EXTRACT(YEAR FROM t.week_start_date) = 2024
  GROUP BY e.employee_id, week_start;","timesheet_entries,timesheets,employees","timesheet_entries.hours,timesheets.week_start_date","projects,hr"
Q0036,challenging,Average time to close support cases in 2024.,Closed cases have status = 'closed'; use opened_at vs updated_at.,"  SELECT ROUND(AVG(updated_at - opened_at), 2) AS avg_close_time
  FROM div_01.cust_srv_case
  WHERE status = 'closed'
    AND EXTRACT(YEAR FROM opened_at) = 2024;",cust_srv_case,"cust_srv_case.opened_at,cust_srv_case.updated_at",support
Q0037,simple,List inventory lots expiring within 60 days.,Use inventory_lots.expiration_date.,"  SELECT lot_id, lot_number, expiration_date
  FROM div_01.inventory_lots
  WHERE expiration_date <= CURRENT_DATE + INTERVAL '60 days';",inventory_lots,"inventory_lots.expiration_date,inventory_lots.lot_number",inventory
Q0038,moderate,Total journal line amounts by cost center for 2022.,Use journal_lines.debit and credit.,"  SELECT cc.name, SUM(jl.debit - jl.credit) AS net_amount
  FROM div_01.journal_lines jl
  JOIN div_01.journal_entries je ON je.entry_id = jl.entry_id
  JOIN div_01.cost_centers cc ON cc.cost_center_id = jl.cost_center_id
  WHERE EXTRACT(YEAR FROM je.entry_date) = 2022
  GROUP BY cc.name;","journal_lines,cost_centers,journal_entries","journal_lines.debit,journal_lines.credit,journal_entries.entry_date",finance
Q0039,simple,Count inventory adjustments by reason in 2023.,Use inventory_adjustments.reason.,"  SELECT reason, COUNT(*) AS adjustment_count
  FROM div_01.inventory_adjustments
  WHERE EXTRACT(YEAR FROM adjustment_date) = 2023
  GROUP BY reason;",inventory_adjustments,"inventory_adjustments.reason,inventory_adjustments.adjustment_date",inventory
Q0040,simple,Number of comments per support case in 2023.,Use support_ticket_comments.comment_ts.,"  SELECT case_id, COUNT(*) AS comment_count
  FROM div_01.support_ticket_comments
  WHERE EXTRACT(YEAR FROM comment_ts) = 2023
  GROUP BY case_id;",support_ticket_comments,support_ticket_comments.comment_ts,support
Q0041,moderate,Total payroll net pay by pay period for 2022.,Payroll tables are payroll_run_hdr and payroll_run_line.,"  SELECT h.pay_period_start, h.pay_period_end, SUM(l.net_pay) AS total_net_pay
  FROM div_01.payroll_run_hdr h
  JOIN div_01.payroll_run_line l ON l.run_id = h.run_id
  WHERE EXTRACT(YEAR FROM h.pay_period_start) = 2022
  GROUP BY h.pay_period_start, h.pay_period_end
  ORDER BY h.pay_period_start;","payroll_run_hdr,payroll_run_line","payroll_run_hdr.pay_period_start,payroll_run_line.net_pay","hr,payroll"
Q0042,moderate,Average allocation percent by project in 2024.,Use project_resources.allocation_percent.,"  SELECT p.name, ROUND(AVG(pr.allocation_percent), 2) AS avg_alloc
  FROM div_01.project_resources pr
  JOIN div_01.projects p ON p.project_id = pr.project_id
  WHERE EXTRACT(YEAR FROM p.start_date) = 2024
  GROUP BY p.name;","project_resources,projects","project_resources.allocation_percent,projects.start_date",projects
Q0043,moderate,Average allocation percent by project in 2023.,Use project_resources.allocation_percent.,"  SELECT p.name, ROUND(AVG(pr.allocation_percent), 2) AS avg_alloc
  FROM div_01.project_resources pr
  JOIN div_01.projects p ON p.project_id = pr.project_id
  WHERE EXTRACT(YEAR FROM p.start_date) = 2023
  GROUP BY p.name;","project_resources,projects","project_resources.allocation_percent,projects.start_date",projects
Q0044,simple,Sales order counts by status for 2024.,Use sales_orders.status.,"  SELECT status, COUNT(*) AS order_count
  FROM div_01.sales_orders
  WHERE EXTRACT(YEAR FROM order_date) = 2024
  GROUP BY status;",sales_orders,"sales_orders.status,sales_orders.order_date",sales
Q0045,moderate,Average discount percentage on sales order lines in 2022.,discount is in order_lines.discount.,"  SELECT ROUND(AVG(ol.discount), 2) AS avg_discount
  FROM div_01.order_lines ol
  JOIN div_01.sales_orders so ON so.order_id = ol.order_id
  WHERE EXTRACT(YEAR FROM so.order_date) = 2022;","order_lines,sales_orders","order_lines.discount,sales_orders.order_date",sales
Q0046,simple,Bank transaction totals by type for 2023.,Use bank_transactions.type.,"  SELECT type, SUM(amount) AS total_amount
  FROM div_01.bank_transactions
  WHERE EXTRACT(YEAR FROM date) = 2023
  GROUP BY type;",bank_transactions,"bank_transactions.type,bank_transactions.amount,bank_transactions.date",finance
Q0047,simple,Bank transaction totals by type for 2022.,Use bank_transactions.type.,"  SELECT type, SUM(amount) AS total_amount
  FROM div_01.bank_transactions
  WHERE EXTRACT(YEAR FROM date) = 2022
  GROUP BY type;",bank_transactions,"bank_transactions.type,bank_transactions.amount,bank_transactions.date",finance
Q0048,moderate,Warehouse locations with low capacity (< 50).,Use warehouse_locations.capacity.,"  SELECT location_id, warehouse_id, aisle, rack, bin, capacity
  FROM div_01.warehouse_locations
  WHERE capacity < 50;",warehouse_locations,warehouse_locations.capacity,inventory
Q0049,simple,List bank accounts with balance under 500.,Use bank_accounts.balance.,"  SELECT bank_account_id, account_number, bank_name, balance
  FROM div_01.bank_accounts
  WHERE balance < 500;",bank_accounts,bank_accounts.balance,finance
Q0050,moderate,Sales orders shipped after ship_date in 2023.,Use sales_orders.ship_date and order_date; assume ship_date is planned date.,"  SELECT order_id, customer_id, order_date, ship_date
  FROM div_01.sales_orders
  WHERE ship_date IS NOT NULL
    AND ship_date > order_date
    AND EXTRACT(YEAR FROM order_date) = 2023;",sales_orders,"sales_orders.ship_date,sales_orders.order_date",sales
Q0051,simple,Number of journal entries by month in 2022.,Use journal_entries.entry_date.,"  SELECT DATE_TRUNC('month', entry_date) AS month, COUNT(*) AS entry_count
  FROM div_01.journal_entries
  WHERE EXTRACT(YEAR FROM entry_date) = 2022
  GROUP BY month
  ORDER BY month;",journal_entries,journal_entries.entry_date,finance
Q0052,moderate,Sales order count by sales region for 2024.,Join sales_orders -> customers -> addresses -> cities -> states_provinces -> countries?,"  SELECT s.name AS state, COUNT(*) AS order_count
  FROM div_01.sales_orders so
  JOIN div_01.customers c ON c.customer_id = so.customer_id
  LEFT JOIN div_01.addresses a ON a.address_id = c.billing_address_id
  LEFT JOIN div_01.cities ci ON ci.city_id = a.city_id
  LEFT JOIN div_01.states_provinces s ON s.state_id = ci.state_id
  WHERE EXTRACT(YEAR FROM so.order_date) = 2024
  GROUP BY s.name
  ORDER BY order_count DESC;","sales_orders,customers,addresses,cities,states_provinces","sales_orders.order_date,customers.customer_id","sales,geography"
Q0053,simple,Customers with credit limit over 500.,Use customers.credit_limit.,"  SELECT customer_id, name, credit_limit
  FROM div_01.customers
  WHERE credit_limit > 500;",customers,customers.credit_limit,sales
Q0054,moderate,Total depreciation by period for 2022.,Use depreciation_entries.period_id and amount.,"  SELECT fp.start_date, SUM(de.amount) AS total_depr
  FROM div_01.depreciation_entries de
  JOIN div_01.fiscal_periods fp ON fp.period_id = de.period_id
  WHERE EXTRACT(YEAR FROM fp.start_date) = 2022
  GROUP BY fp.start_date
  ORDER BY fp.start_date;","depreciation_entries,fiscal_periods","depreciation_entries.amount,fiscal_periods.start_date","assets,finance"
Q0055,moderate,Training completion rate by course for 2022.,Use employee_training.completion_date.,"  SELECT c.name, COUNT(*) AS completions
  FROM div_01.employee_training et
  JOIN div_01.training_courses c ON c.course_id = et.course_id
  WHERE EXTRACT(YEAR FROM et.completion_date) = 2022
  GROUP BY c.name
  ORDER BY completions DESC;","training_courses,employee_training",employee_training.completion_date,"hr,training"
Q0056,simple,List inactive vendors.,Use vendors.is_active.,"  SELECT vendor_id, name
  FROM div_01.vendors
  WHERE is_active = FALSE;",vendors,vendors.is_active,procurement
Q0057,moderate,QC failure rate for inventory lots in 2022.,Fail results have result = 'fail'.,"  SELECT
    ROUND(100.0 * SUM(CASE WHEN qi.result = 'fail' THEN 1 ELSE 0 END) / COUNT(*), 2) AS fail_pct
  FROM div_01.inventory_qc_inspections qi
  WHERE EXTRACT(YEAR FROM qi.inspection_date) = 2022;","inventory_qc_inspections,inventory_lots","inventory_qc_inspections.result,inventory_qc_inspections.inspection_date","inventory,qc"
Q0058,moderate,Total payroll net pay by pay period for 2023.,Payroll tables are payroll_run_hdr and payroll_run_line.,"  SELECT h.pay_period_start, h.pay_period_end, SUM(l.net_pay) AS total_net_pay
  FROM div_01.payroll_run_hdr h
  JOIN div_01.payroll_run_line l ON l.run_id = h.run_id
  WHERE EXTRACT(YEAR FROM h.pay_period_start) = 2023
  GROUP BY h.pay_period_start, h.pay_period_end
  ORDER BY h.pay_period_start;","payroll_run_hdr,payroll_run_line","payroll_run_hdr.pay_period_start,payroll_run_line.net_pay","hr,payroll"
Q0059,moderate,Headcount by department for 2022.,Use employees.department_id.,"  SELECT d.name, COUNT(*) AS headcount
  FROM div_01.employees e
  JOIN div_01.departments d ON d.department_id = e.department_id
  WHERE EXTRACT(YEAR FROM e.hire_date) <= 2022
  GROUP BY d.name
  ORDER BY headcount DESC;","employees,departments",employees.department_id,hr
Q0060,simple,Customers with credit limit over 10000.,Use customers.credit_limit.,"  SELECT customer_id, name, credit_limit
  FROM div_01.customers
  WHERE credit_limit > 10000;",customers,customers.credit_limit,sales
Q0061,simple,Number of comments per support case in 2022.,Use support_ticket_comments.comment_ts.,"  SELECT case_id, COUNT(*) AS comment_count
  FROM div_01.support_ticket_comments
  WHERE EXTRACT(YEAR FROM comment_ts) = 2022
  GROUP BY case_id;",support_ticket_comments,support_ticket_comments.comment_ts,support
Q0062,moderate,Warehouse locations with low capacity (< 250).,Use warehouse_locations.capacity.,"  SELECT location_id, warehouse_id, aisle, rack, bin, capacity
  FROM div_01.warehouse_locations
  WHERE capacity < 250;",warehouse_locations,warehouse_locations.capacity,inventory
Q0063,moderate,Average allocation percent by project in 2022.,Use project_resources.allocation_percent.,"  SELECT p.name, ROUND(AVG(pr.allocation_percent), 2) AS avg_alloc
  FROM div_01.project_resources pr
  JOIN div_01.projects p ON p.project_id = pr.project_id
  WHERE EXTRACT(YEAR FROM p.start_date) = 2022
  GROUP BY p.name;","project_resources,projects","project_resources.allocation_percent,projects.start_date",projects
Q0064,challenging,Departments where actual expenses exceed budget in 2022.,Compare project_expenses vs budgets by department.,"  SELECT d.name, b.total_amount, COALESCE(SUM(pe.amount),0) AS actual_spend
  FROM div_01.budgets b
  JOIN div_01.departments d ON d.department_id = b.department_id
  LEFT JOIN div_01.project_expenses pe ON pe.project_id IS NOT NULL
  WHERE EXTRACT(YEAR FROM b.created_at) = 2022
  GROUP BY d.name, b.total_amount
  HAVING COALESCE(SUM(pe.amount),0) > b.total_amount;","budgets,budget_lines,project_expenses,departments","budgets.total_amount,project_expenses.amount","finance,projects"
Q0065,moderate,Average discount percentage on sales order lines in 2021.,discount is in order_lines.discount.,"  SELECT ROUND(AVG(ol.discount), 2) AS avg_discount
  FROM div_01.order_lines ol
  JOIN div_01.sales_orders so ON so.order_id = ol.order_id
  WHERE EXTRACT(YEAR FROM so.order_date) = 2021;","order_lines,sales_orders","order_lines.discount,sales_orders.order_date",sales
Q0066,moderate,Assets transferred between locations in 2021.,Use asset_transfers.transfer_date.,"  SELECT transfer_id, asset_id, from_location_id, to_location_id, transfer_date
  FROM div_01.asset_transfers
  WHERE EXTRACT(YEAR FROM transfer_date) = 2021;",asset_transfers,asset_transfers.transfer_date,assets
Q0067,simple,List open AR invoices over 1000 in 2023.,AR invoices are in finance_ar_invoices.,"  SELECT ar_invoice_id, invoice_number, amount, status
  FROM div_01.finance_ar_invoices
  WHERE status = 'open'
    AND amount > 1000
    AND EXTRACT(YEAR FROM invoice_date) = 2023;",finance_ar_invoices,"finance_ar_invoices.amount,finance_ar_invoices.status,finance_ar_invoices.invoice_date","finance,ar"
Q0068,challenging,Average days between PO order date and goods receipt for each vendor in 2024.,Join purchase_orders -> goods_receipts -> vendors.,"  SELECT v.name, ROUND(AVG(gr.receipt_date - po.order_date), 2) AS avg_days
  FROM div_01.purchase_orders po
  JOIN div_01.goods_receipts gr ON gr.po_id = po.po_id
  JOIN div_01.vendors v ON v.vendor_id = po.vendor_id
  WHERE EXTRACT(YEAR FROM po.order_date) = 2024
  GROUP BY v.name
  ORDER BY avg_days;","purchase_orders,goods_receipts,vendors","purchase_orders.order_date,goods_receipts.receipt_date,vendors.name",procurement
Q0069,simple,Sales order counts by status for 2023.,Use sales_orders.status.,"  SELECT status, COUNT(*) AS order_count
  FROM div_01.sales_orders
  WHERE EXTRACT(YEAR FROM order_date) = 2023
  GROUP BY status;",sales_orders,"sales_orders.status,sales_orders.order_date",sales
Q0070,simple,Number of comments per support case in 2023.,Use support_ticket_comments.comment_ts.,"  SELECT case_id, COUNT(*) AS comment_count
  FROM div_01.support_ticket_comments
  WHERE EXTRACT(YEAR FROM comment_ts) = 2023
  GROUP BY case_id;",support_ticket_comments,support_ticket_comments.comment_ts,support
Q0071,challenging,Quote-to-order conversion rate for 2022.,Join sales_quotes to sales_orders by customer and dates.,"  SELECT
    ROUND(100.0 * COUNT(DISTINCT so.order_id) / NULLIF(COUNT(DISTINCT sq.quote_id),0), 2) AS conversion_pct
  FROM div_01.sales_quotes sq
  LEFT JOIN div_01.sales_orders so ON so.customer_id = sq.customer_id
  WHERE EXTRACT(YEAR FROM sq.quote_date) = 2022;","sales_quotes,sales_orders","sales_quotes.quote_date,sales_orders.order_date",sales
Q0072,moderate,Total AP invoice amount by vendor for 2022.,Join finance_ap_invoices to vendors.,"  SELECT v.name, SUM(ai.amount) AS total_amount
  FROM div_01.finance_ap_invoices ai
  JOIN div_01.vendors v ON v.vendor_id = ai.vendor_id
  WHERE EXTRACT(YEAR FROM ai.invoice_date) = 2022
  GROUP BY v.name
  ORDER BY total_amount DESC;","finance_ap_invoices,vendors","finance_ap_invoices.amount,finance_ap_invoices.invoice_date,vendors.name","finance,ap"
Q0073,challenging,Project margin = (budget - actual expenses) for active projects in 2021.,"Use projects, project_budgets, project_expenses.","  SELECT p.project_id, p.name,
         pb.planned_amount - COALESCE(SUM(pe.amount),0) AS margin
  FROM div_01.projects p
  JOIN div_01.project_budgets pb ON pb.project_id = p.project_id
  LEFT JOIN div_01.project_expenses pe ON pe.project_id = p.project_id
  WHERE p.status = 'active'
    AND EXTRACT(YEAR FROM p.start_date) = 2021
  GROUP BY p.project_id, p.name, pb.planned_amount
  ORDER BY margin DESC;","projects,project_budgets,project_expenses","projects.status,project_budgets.planned_amount,project_expenses.amount",projects
Q0074,simple,Timesheets awaiting approval in 2024.,Use timesheets.status = 'submitted'.,"  SELECT timesheet_id, employee_id, week_start_date, status
  FROM div_01.timesheets
  WHERE status = 'submitted'
    AND EXTRACT(YEAR FROM week_start_date) = 2024;",timesheets,"timesheets.status,timesheets.week_start_date",projects
Q0075,moderate,Count of open customer service cases by priority.,Use cust_srv_case; open/pending are not closed.,"  SELECT priority, COUNT(*) AS case_count
  FROM div_01.cust_srv_case
  WHERE status IN ('open','pending')
  GROUP BY priority;",cust_srv_case,"cust_srv_case.status,cust_srv_case.priority",support
Q0076,simple,Timesheets awaiting approval in 2022.,Use timesheets.status = 'submitted'.,"  SELECT timesheet_id, employee_id, week_start_date, status
  FROM div_01.timesheets
  WHERE status = 'submitted'
    AND EXTRACT(YEAR FROM week_start_date) = 2022;",timesheets,"timesheets.status,timesheets.week_start_date",projects
Q0077,challenging,Employee utilization rate = hours logged / 40 by week in 2021.,Use timesheet_entries.hours.,"  SELECT e.employee_id, DATE_TRUNC('week', t.week_start_date) AS week_start,
         ROUND(SUM(te.hours) / 40.0, 2) AS utilization
  FROM div_01.timesheets t
  JOIN div_01.timesheet_entries te ON te.timesheet_id = t.timesheet_id
  JOIN div_01.employees e ON e.employee_id = t.employee_id
  WHERE EXTRACT(YEAR FROM t.week_start_date) = 2021
  GROUP BY e.employee_id, week_start;","timesheet_entries,timesheets,employees","timesheet_entries.hours,timesheets.week_start_date","projects,hr"
Q0078,challenging,Departments where actual expenses exceed budget in 2021.,Compare project_expenses vs budgets by department.,"  SELECT d.name, b.total_amount, COALESCE(SUM(pe.amount),0) AS actual_spend
  FROM div_01.budgets b
  JOIN div_01.departments d ON d.department_id = b.department_id
  LEFT JOIN div_01.project_expenses pe ON pe.project_id IS NOT NULL
  WHERE EXTRACT(YEAR FROM b.created_at) = 2021
  GROUP BY d.name, b.total_amount
  HAVING COALESCE(SUM(pe.amount),0) > b.total_amount;","budgets,budget_lines,project_expenses,departments","budgets.total_amount,project_expenses.amount","finance,projects"
Q0079,moderate,Headcount by department for 2022.,Use employees.department_id.,"  SELECT d.name, COUNT(*) AS headcount
  FROM div_01.employees e
  JOIN div_01.departments d ON d.department_id = e.department_id
  WHERE EXTRACT(YEAR FROM e.hire_date) <= 2022
  GROUP BY d.name
  ORDER BY headcount DESC;","employees,departments",employees.department_id,hr
Q0080,moderate,Assets transferred between locations in 2023.,Use asset_transfers.transfer_date.,"  SELECT transfer_id, asset_id, from_location_id, to_location_id, transfer_date
  FROM div_01.asset_transfers
  WHERE EXTRACT(YEAR FROM transfer_date) = 2023;",asset_transfers,asset_transfers.transfer_date,assets
Q0081,moderate,Products below reorder minimum by warehouse.,Join reorder_rules to inventory_levels.,"  SELECT w.warehouse_id, p.sku, il.quantity_on_hand, rr.min_quantity
  FROM div_01.reorder_rules rr
  JOIN div_01.inventory_levels il ON il.product_id = rr.product_id AND il.warehouse_id = rr.warehouse_id
  JOIN div_01.products p ON p.product_id = rr.product_id
  WHERE il.quantity_on_hand < rr.min_quantity;","reorder_rules,inventory_levels,products","reorder_rules.min_quantity,inventory_levels.quantity_on_hand",inventory
Q0082,moderate,Sales order count by sales region for 2024.,Join sales_orders -> customers -> addresses -> cities -> states_provinces -> countries?,"  SELECT s.name AS state, COUNT(*) AS order_count
  FROM div_01.sales_orders so
  JOIN div_01.customers c ON c.customer_id = so.customer_id
  LEFT JOIN div_01.addresses a ON a.address_id = c.billing_address_id
  LEFT JOIN div_01.cities ci ON ci.city_id = a.city_id
  LEFT JOIN div_01.states_provinces s ON s.state_id = ci.state_id
  WHERE EXTRACT(YEAR FROM so.order_date) = 2024
  GROUP BY s.name
  ORDER BY order_count DESC;","sales_orders,customers,addresses,cities,states_provinces","sales_orders.order_date,customers.customer_id","sales,geography"
Q0083,moderate,Products below reorder minimum by warehouse.,Join reorder_rules to inventory_levels.,"  SELECT w.warehouse_id, p.sku, il.quantity_on_hand, rr.min_quantity
  FROM div_01.reorder_rules rr
  JOIN div_01.inventory_levels il ON il.product_id = rr.product_id AND il.warehouse_id = rr.warehouse_id
  JOIN div_01.products p ON p.product_id = rr.product_id
  WHERE il.quantity_on_hand < rr.min_quantity;","reorder_rules,inventory_levels,products","reorder_rules.min_quantity,inventory_levels.quantity_on_hand",inventory
Q0084,moderate,Assets transferred between locations in 2022.,Use asset_transfers.transfer_date.,"  SELECT transfer_id, asset_id, from_location_id, to_location_id, transfer_date
  FROM div_01.asset_transfers
  WHERE EXTRACT(YEAR FROM transfer_date) = 2022;",asset_transfers,asset_transfers.transfer_date,assets
Q0085,simple,List open AR invoices over 10000 in 2021.,AR invoices are in finance_ar_invoices.,"  SELECT ar_invoice_id, invoice_number, amount, status
  FROM div_01.finance_ar_invoices
  WHERE status = 'open'
    AND amount > 10000
    AND EXTRACT(YEAR FROM invoice_date) = 2021;",finance_ar_invoices,"finance_ar_invoices.amount,finance_ar_invoices.status,finance_ar_invoices.invoice_date","finance,ar"
Q0086,moderate,Open opportunities by stage for 2022.,Join sales_opportunities to opportunity_stages.,"  SELECT os.name, COUNT(*) AS opportunity_count
  FROM div_01.sales_opportunities so
  JOIN div_01.opportunity_stages os ON os.stage_id = so.stage_id
  WHERE EXTRACT(YEAR FROM so.close_date) = 2022
  GROUP BY os.name;","sales_opportunities,opportunity_stages","sales_opportunities.close_date,opportunity_stages.name",sales
Q0087,moderate,Top 5 vendors by total spend in 2023.,Use purchase_orders.total and vendor names.,"  SELECT v.name, SUM(po.total) AS total_spend
  FROM div_01.purchase_orders po
  JOIN div_01.vendors v ON v.vendor_id = po.vendor_id
  WHERE EXTRACT(YEAR FROM po.order_date) = 2023
  GROUP BY v.name
  ORDER BY total_spend DESC
  LIMIT 5;","purchase_orders,vendors","purchase_orders.total,purchase_orders.order_date,vendors.name",procurement
Q0088,moderate,Total AP invoice amount by vendor for 2024.,Join finance_ap_invoices to vendors.,"  SELECT v.name, SUM(ai.amount) AS total_amount
  FROM div_01.finance_ap_invoices ai
  JOIN div_01.vendors v ON v.vendor_id = ai.vendor_id
  WHERE EXTRACT(YEAR FROM ai.invoice_date) = 2024
  GROUP BY v.name
  ORDER BY total_amount DESC;","finance_ap_invoices,vendors","finance_ap_invoices.amount,finance_ap_invoices.invoice_date,vendors.name","finance,ap"
Q0089,challenging,Departments where actual expenses exceed budget in 2024.,Compare project_expenses vs budgets by department.,"  SELECT d.name, b.total_amount, COALESCE(SUM(pe.amount),0) AS actual_spend
  FROM div_01.budgets b
  JOIN div_01.departments d ON d.department_id = b.department_id
  LEFT JOIN div_01.project_expenses pe ON pe.project_id IS NOT NULL
  WHERE EXTRACT(YEAR FROM b.created_at) = 2024
  GROUP BY d.name, b.total_amount
  HAVING COALESCE(SUM(pe.amount),0) > b.total_amount;","budgets,budget_lines,project_expenses,departments","budgets.total_amount,project_expenses.amount","finance,projects"
Q0090,challenging,Quote-to-order conversion rate for 2021.,Join sales_quotes to sales_orders by customer and dates.,"  SELECT
    ROUND(100.0 * COUNT(DISTINCT so.order_id) / NULLIF(COUNT(DISTINCT sq.quote_id),0), 2) AS conversion_pct
  FROM div_01.sales_quotes sq
  LEFT JOIN div_01.sales_orders so ON so.customer_id = sq.customer_id
  WHERE EXTRACT(YEAR FROM sq.quote_date) = 2021;","sales_quotes,sales_orders","sales_quotes.quote_date,sales_orders.order_date",sales
Q0091,moderate,Sales orders shipped after ship_date in 2022.,Use sales_orders.ship_date and order_date; assume ship_date is planned date.,"  SELECT order_id, customer_id, order_date, ship_date
  FROM div_01.sales_orders
  WHERE ship_date IS NOT NULL
    AND ship_date > order_date
    AND EXTRACT(YEAR FROM order_date) = 2022;",sales_orders,"sales_orders.ship_date,sales_orders.order_date",sales
Q0092,moderate,Top expense categories for 2021.,Use project_expenses.category and amount.,"  SELECT category, SUM(amount) AS total
  FROM div_01.project_expenses
  WHERE EXTRACT(YEAR FROM expense_date) = 2021
  GROUP BY category
  ORDER BY total DESC;",project_expenses,"project_expenses.category,project_expenses.amount,project_expenses.expense_date",projects
Q0093,moderate,Total AP invoice amount by vendor for 2021.,Join finance_ap_invoices to vendors.,"  SELECT v.name, SUM(ai.amount) AS total_amount
  FROM div_01.finance_ap_invoices ai
  JOIN div_01.vendors v ON v.vendor_id = ai.vendor_id
  WHERE EXTRACT(YEAR FROM ai.invoice_date) = 2021
  GROUP BY v.name
  ORDER BY total_amount DESC;","finance_ap_invoices,vendors","finance_ap_invoices.amount,finance_ap_invoices.invoice_date,vendors.name","finance,ap"
Q0094,moderate,Benefit election count by coverage level in 2021.,Use hr_benefit_elections.election_date.,"  SELECT coverage_level, COUNT(*) AS elections
  FROM div_01.hr_benefit_elections
  WHERE EXTRACT(YEAR FROM election_date) = 2021
  GROUP BY coverage_level;",hr_benefit_elections,"hr_benefit_elections.coverage_level,hr_benefit_elections.election_date","hr,benefits"
Q0095,moderate,Top 5 vendors by total spend in 2022.,Use purchase_orders.total and vendor names.,"  SELECT v.name, SUM(po.total) AS total_spend
  FROM div_01.purchase_orders po
  JOIN div_01.vendors v ON v.vendor_id = po.vendor_id
  WHERE EXTRACT(YEAR FROM po.order_date) = 2022
  GROUP BY v.name
  ORDER BY total_spend DESC
  LIMIT 5;","purchase_orders,vendors","purchase_orders.total,purchase_orders.order_date,vendors.name",procurement
Q0096,moderate,Average allocation percent by project in 2024.,Use project_resources.allocation_percent.,"  SELECT p.name, ROUND(AVG(pr.allocation_percent), 2) AS avg_alloc
  FROM div_01.project_resources pr
  JOIN div_01.projects p ON p.project_id = pr.project_id
  WHERE EXTRACT(YEAR FROM p.start_date) = 2024
  GROUP BY p.name;","project_resources,projects","project_resources.allocation_percent,projects.start_date",projects
Q0097,moderate,Warehouse locations with low capacity (< 50).,Use warehouse_locations.capacity.,"  SELECT location_id, warehouse_id, aisle, rack, bin, capacity
  FROM div_01.warehouse_locations
  WHERE capacity < 50;",warehouse_locations,warehouse_locations.capacity,inventory
Q0098,moderate,Top expense categories for 2024.,Use project_expenses.category and amount.,"  SELECT category, SUM(amount) AS total
  FROM div_01.project_expenses
  WHERE EXTRACT(YEAR FROM expense_date) = 2024
  GROUP BY category
  ORDER BY total DESC;",project_expenses,"project_expenses.category,project_expenses.amount,project_expenses.expense_date",projects
Q0099,simple,Bank transaction totals by type for 2021.,Use bank_transactions.type.,"  SELECT type, SUM(amount) AS total_amount
  FROM div_01.bank_transactions
  WHERE EXTRACT(YEAR FROM date) = 2021
  GROUP BY type;",bank_transactions,"bank_transactions.type,bank_transactions.amount,bank_transactions.date",finance
Q0100,moderate,Sales order count by sales region for 2023.,Join sales_orders -> customers -> addresses -> cities -> states_provinces -> countries?,"  SELECT s.name AS state, COUNT(*) AS order_count
  FROM div_01.sales_orders so
  JOIN div_01.customers c ON c.customer_id = so.customer_id
  LEFT JOIN div_01.addresses a ON a.address_id = c.billing_address_id
  LEFT JOIN div_01.cities ci ON ci.city_id = a.city_id
  LEFT JOIN div_01.states_provinces s ON s.state_id = ci.state_id
  WHERE EXTRACT(YEAR FROM so.order_date) = 2023
  GROUP BY s.name
  ORDER BY order_count DESC;","sales_orders,customers,addresses,cities,states_provinces","sales_orders.order_date,customers.customer_id","sales,geography"
Q0101,simple,List inactive vendors.,Use vendors.is_active.,"  SELECT vendor_id, name
  FROM div_01.vendors
  WHERE is_active = FALSE;",vendors,vendors.is_active,procurement
Q0102,challenging,Average days from requisition to PO for 2022.,Join purchase_requisitions to purchase_orders by requested_by (approx).,"  SELECT ROUND(AVG(po.order_date - pr.request_date), 2) AS avg_days
  FROM div_01.purchase_requisitions pr
  JOIN div_01.purchase_orders po ON po.created_by = pr.requested_by
  WHERE EXTRACT(YEAR FROM pr.request_date) = 2022;","purchase_requisitions,purchase_orders","purchase_requisitions.request_date,purchase_orders.order_date",procurement
Q0103,simple,List bank accounts with balance under 5000.,Use bank_accounts.balance.,"  SELECT bank_account_id, account_number, bank_name, balance
  FROM div_01.bank_accounts
  WHERE balance < 5000;",bank_accounts,bank_accounts.balance,finance
Q0104,moderate,Sales orders shipped after ship_date in 2024.,Use sales_orders.ship_date and order_date; assume ship_date is planned date.,"  SELECT order_id, customer_id, order_date, ship_date
  FROM div_01.sales_orders
  WHERE ship_date IS NOT NULL
    AND ship_date > order_date
    AND EXTRACT(YEAR FROM order_date) = 2024;",sales_orders,"sales_orders.ship_date,sales_orders.order_date",sales
Q0105,moderate,Open opportunities by stage for 2021.,Join sales_opportunities to opportunity_stages.,"  SELECT os.name, COUNT(*) AS opportunity_count
  FROM div_01.sales_opportunities so
  JOIN div_01.opportunity_stages os ON os.stage_id = so.stage_id
  WHERE EXTRACT(YEAR FROM so.close_date) = 2021
  GROUP BY os.name;","sales_opportunities,opportunity_stages","sales_opportunities.close_date,opportunity_stages.name",sales
Q0106,moderate,Total depreciation by period for 2024.,Use depreciation_entries.period_id and amount.,"  SELECT fp.start_date, SUM(de.amount) AS total_depr
  FROM div_01.depreciation_entries de
  JOIN div_01.fiscal_periods fp ON fp.period_id = de.period_id
  WHERE EXTRACT(YEAR FROM fp.start_date) = 2024
  GROUP BY fp.start_date
  ORDER BY fp.start_date;","depreciation_entries,fiscal_periods","depreciation_entries.amount,fiscal_periods.start_date","assets,finance"
Q0107,challenging,Inventory turns by product category for 2023.,Approximate turns using inventory_transactions quantity.,"  SELECT pc.name, SUM(it.quantity) AS total_moved
  FROM div_01.inventory_transactions it
  JOIN div_01.products p ON p.product_id = it.product_id
  JOIN div_01.product_categories pc ON pc.category_id = p.category_id
  WHERE EXTRACT(YEAR FROM it.date) = 2023
  GROUP BY pc.name
  ORDER BY total_moved DESC;","inventory_transactions,products,product_categories","inventory_transactions.quantity,inventory_transactions.date,product_categories.name",inventory
Q0108,challenging,Departments where actual expenses exceed budget in 2024.,Compare project_expenses vs budgets by department.,"  SELECT d.name, b.total_amount, COALESCE(SUM(pe.amount),0) AS actual_spend
  FROM div_01.budgets b
  JOIN div_01.departments d ON d.department_id = b.department_id
  LEFT JOIN div_01.project_expenses pe ON pe.project_id IS NOT NULL
  WHERE EXTRACT(YEAR FROM b.created_at) = 2024
  GROUP BY d.name, b.total_amount
  HAVING COALESCE(SUM(pe.amount),0) > b.total_amount;","budgets,budget_lines,project_expenses,departments","budgets.total_amount,project_expenses.amount","finance,projects"
Q0109,moderate,Total payroll net pay by pay period for 2021.,Payroll tables are payroll_run_hdr and payroll_run_line.,"  SELECT h.pay_period_start, h.pay_period_end, SUM(l.net_pay) AS total_net_pay
  FROM div_01.payroll_run_hdr h
  JOIN div_01.payroll_run_line l ON l.run_id = h.run_id
  WHERE EXTRACT(YEAR FROM h.pay_period_start) = 2021
  GROUP BY h.pay_period_start, h.pay_period_end
  ORDER BY h.pay_period_start;","payroll_run_hdr,payroll_run_line","payroll_run_hdr.pay_period_start,payroll_run_line.net_pay","hr,payroll"
Q0110,moderate,Training completion rate by course for 2023.,Use employee_training.completion_date.,"  SELECT c.name, COUNT(*) AS completions
  FROM div_01.employee_training et
  JOIN div_01.training_courses c ON c.course_id = et.course_id
  WHERE EXTRACT(YEAR FROM et.completion_date) = 2023
  GROUP BY c.name
  ORDER BY completions DESC;","training_courses,employee_training",employee_training.completion_date,"hr,training"
Q0111,simple,Number of comments per support case in 2022.,Use support_ticket_comments.comment_ts.,"  SELECT case_id, COUNT(*) AS comment_count
  FROM div_01.support_ticket_comments
  WHERE EXTRACT(YEAR FROM comment_ts) = 2022
  GROUP BY case_id;",support_ticket_comments,support_ticket_comments.comment_ts,support
Q0112,simple,Sales order counts by status for 2021.,Use sales_orders.status.,"  SELECT status, COUNT(*) AS order_count
  FROM div_01.sales_orders
  WHERE EXTRACT(YEAR FROM order_date) = 2021
  GROUP BY status;",sales_orders,"sales_orders.status,sales_orders.order_date",sales
Q0113,simple,Number of journal entries by month in 2023.,Use journal_entries.entry_date.,"  SELECT DATE_TRUNC('month', entry_date) AS month, COUNT(*) AS entry_count
  FROM div_01.journal_entries
  WHERE EXTRACT(YEAR FROM entry_date) = 2023
  GROUP BY month
  ORDER BY month;",journal_entries,journal_entries.entry_date,finance
Q0114,moderate,Open opportunities by stage for 2021.,Join sales_opportunities to opportunity_stages.,"  SELECT os.name, COUNT(*) AS opportunity_count
  FROM div_01.sales_opportunities so
  JOIN div_01.opportunity_stages os ON os.stage_id = so.stage_id
  WHERE EXTRACT(YEAR FROM so.close_date) = 2021
  GROUP BY os.name;","sales_opportunities,opportunity_stages","sales_opportunities.close_date,opportunity_stages.name",sales
Q0115,simple,Primary contacts for customers in North region.,Region is on sales_regions; join customers -> sales_territories -> sales_regions.,"  SELECT c.name AS customer, cc.name AS contact, cc.email
  FROM div_01.customers c
  JOIN div_01.sales_territories st ON st.assigned_rep_id = c.customer_id
  JOIN div_01.sales_regions sr ON sr.region_id = st.region_id
  JOIN div_01.customer_contacts cc ON cc.customer_id = c.customer_id
  WHERE cc.is_primary = TRUE
    AND sr.name = 'North';","customers,sales_territories,sales_regions,customer_contacts","customer_contacts.is_primary,sales_regions.name",sales
Q0116,simple,Sales order counts by status for 2021.,Use sales_orders.status.,"  SELECT status, COUNT(*) AS order_count
  FROM div_01.sales_orders
  WHERE EXTRACT(YEAR FROM order_date) = 2021
  GROUP BY status;",sales_orders,"sales_orders.status,sales_orders.order_date",sales
Q0117,moderate,Warehouse locations with low capacity (< 100).,Use warehouse_locations.capacity.,"  SELECT location_id, warehouse_id, aisle, rack, bin, capacity
  FROM div_01.warehouse_locations
  WHERE capacity < 100;",warehouse_locations,warehouse_locations.capacity,inventory
Q0118,simple,Vendors with payment terms containing 'net 60'.,Use vendors.payment_terms.,"  SELECT vendor_id, name, payment_terms
  FROM div_01.vendors
  WHERE payment_terms ILIKE '%' || 'net 60' || '%';",vendors,vendors.payment_terms,procurement
Q0119,moderate,Total journal line amounts by cost center for 2022.,Use journal_lines.debit and credit.,"  SELECT cc.name, SUM(jl.debit - jl.credit) AS net_amount
  FROM div_01.journal_lines jl
  JOIN div_01.journal_entries je ON je.entry_id = jl.entry_id
  JOIN div_01.cost_centers cc ON cc.cost_center_id = jl.cost_center_id
  WHERE EXTRACT(YEAR FROM je.entry_date) = 2022
  GROUP BY cc.name;","journal_lines,cost_centers,journal_entries","journal_lines.debit,journal_lines.credit,journal_entries.entry_date",finance
Q0120,moderate,QC failure rate for inventory lots in 2022.,Fail results have result = 'fail'.,"  SELECT
    ROUND(100.0 * SUM(CASE WHEN qi.result = 'fail' THEN 1 ELSE 0 END) / COUNT(*), 2) AS fail_pct
  FROM div_01.inventory_qc_inspections qi
  WHERE EXTRACT(YEAR FROM qi.inspection_date) = 2022;","inventory_qc_inspections,inventory_lots","inventory_qc_inspections.result,inventory_qc_inspections.inspection_date","inventory,qc"
Q0121,moderate,Total payroll net pay by pay period for 2023.,Payroll tables are payroll_run_hdr and payroll_run_line.,"  SELECT h.pay_period_start, h.pay_period_end, SUM(l.net_pay) AS total_net_pay
  FROM div_01.payroll_run_hdr h
  JOIN div_01.payroll_run_line l ON l.run_id = h.run_id
  WHERE EXTRACT(YEAR FROM h.pay_period_start) = 2023
  GROUP BY h.pay_period_start, h.pay_period_end
  ORDER BY h.pay_period_start;","payroll_run_hdr,payroll_run_line","payroll_run_hdr.pay_period_start,payroll_run_line.net_pay","hr,payroll"
Q0122,simple,Number of journal entries by month in 2021.,Use journal_entries.entry_date.,"  SELECT DATE_TRUNC('month', entry_date) AS month, COUNT(*) AS entry_count
  FROM div_01.journal_entries
  WHERE EXTRACT(YEAR FROM entry_date) = 2021
  GROUP BY month
  ORDER BY month;",journal_entries,journal_entries.entry_date,finance
Q0123,moderate,Average discount percentage on sales order lines in 2023.,discount is in order_lines.discount.,"  SELECT ROUND(AVG(ol.discount), 2) AS avg_discount
  FROM div_01.order_lines ol
  JOIN div_01.sales_orders so ON so.order_id = ol.order_id
  WHERE EXTRACT(YEAR FROM so.order_date) = 2023;","order_lines,sales_orders","order_lines.discount,sales_orders.order_date",sales
Q0124,challenging,Average days from RFQ to vendor response for 2024.,Join procurement_rfqs to procurement_rfq_responses.,"  SELECT ROUND(AVG(r.response_date - q.rfq_date), 2) AS avg_days
  FROM div_01.procurement_rfqs q
  JOIN div_01.procurement_rfq_responses r ON r.rfq_id = q.rfq_id
  WHERE EXTRACT(YEAR FROM q.rfq_date) = 2024;","procurement_rfqs,procurement_rfq_responses","procurement_rfqs.rfq_date,procurement_rfq_responses.response_date","procurement,time"
Q0125,moderate,Approval rate of purchase orders in 2023.,Use procurement_po_approvals; approved vs rejected.,"  SELECT
    ROUND(100.0 * SUM(CASE WHEN status = 'approved' THEN 1 ELSE 0 END) / COUNT(*), 2) AS approval_pct
  FROM div_01.procurement_po_approvals
  WHERE EXTRACT(YEAR FROM approval_date) = 2023;",procurement_po_approvals,"procurement_po_approvals.status,procurement_po_approvals.approval_date",procurement
Q0126,moderate,Average days between vendor invoice date and due date by vendor.,Use vendor_invoices.invoice_date and due_date.,"  SELECT v.name, ROUND(AVG(vi.due_date - vi.invoice_date), 2) AS avg_days
  FROM div_01.vendor_invoices vi
  JOIN div_01.vendors v ON v.vendor_id = vi.vendor_id
  GROUP BY v.name;","vendor_invoices,vendors","vendor_invoices.invoice_date,vendor_invoices.due_date",procurement
Q0127,moderate,Total journal line amounts by cost center for 2021.,Use journal_lines.debit and credit.,"  SELECT cc.name, SUM(jl.debit - jl.credit) AS net_amount
  FROM div_01.journal_lines jl
  JOIN div_01.journal_entries je ON je.entry_id = jl.entry_id
  JOIN div_01.cost_centers cc ON cc.cost_center_id = jl.cost_center_id
  WHERE EXTRACT(YEAR FROM je.entry_date) = 2021
  GROUP BY cc.name;","journal_lines,cost_centers,journal_entries","journal_lines.debit,journal_lines.credit,journal_entries.entry_date",finance
Q0128,simple,List inventory lots expiring within 60 days.,Use inventory_lots.expiration_date.,"  SELECT lot_id, lot_number, expiration_date
  FROM div_01.inventory_lots
  WHERE expiration_date <= CURRENT_DATE + INTERVAL '60 days';",inventory_lots,"inventory_lots.expiration_date,inventory_lots.lot_number",inventory
Q0129,challenging,Employee turnover rate for 2024.,Turnover = terminations / average headcount.,"  WITH terminations AS (
    SELECT COUNT(*) AS term_count
    FROM div_01.employees
    WHERE EXTRACT(YEAR FROM termination_date) = 2024
  ),
  headcount AS (
    SELECT COUNT(*) AS headcount
    FROM div_01.employees
    WHERE hire_date <= DATE '2024-12-31'
      AND (termination_date IS NULL OR termination_date > DATE '2024-01-01')
  )
  SELECT ROUND(100.0 * t.term_count / NULLIF(h.headcount,0), 2) AS turnover_pct
  FROM terminations t, headcount h;",employees,"employees.termination_date,employees.hire_date",hr
Q0130,simple,Timesheets awaiting approval in 2022.,Use timesheets.status = 'submitted'.,"  SELECT timesheet_id, employee_id, week_start_date, status
  FROM div_01.timesheets
  WHERE status = 'submitted'
    AND EXTRACT(YEAR FROM week_start_date) = 2022;",timesheets,"timesheets.status,timesheets.week_start_date",projects
Q0131,moderate,Total AP invoice amount by vendor for 2022.,Join finance_ap_invoices to vendors.,"  SELECT v.name, SUM(ai.amount) AS total_amount
  FROM div_01.finance_ap_invoices ai
  JOIN div_01.vendors v ON v.vendor_id = ai.vendor_id
  WHERE EXTRACT(YEAR FROM ai.invoice_date) = 2022
  GROUP BY v.name
  ORDER BY total_amount DESC;","finance_ap_invoices,vendors","finance_ap_invoices.amount,finance_ap_invoices.invoice_date,vendors.name","finance,ap"
Q0132,challenging,Project margin = (budget - actual expenses) for active projects in 2024.,"Use projects, project_budgets, project_expenses.","  SELECT p.project_id, p.name,
         pb.planned_amount - COALESCE(SUM(pe.amount),0) AS margin
  FROM div_01.projects p
  JOIN div_01.project_budgets pb ON pb.project_id = p.project_id
  LEFT JOIN div_01.project_expenses pe ON pe.project_id = p.project_id
  WHERE p.status = 'active'
    AND EXTRACT(YEAR FROM p.start_date) = 2024
  GROUP BY p.project_id, p.name, pb.planned_amount
  ORDER BY margin DESC;","projects,project_budgets,project_expenses","projects.status,project_budgets.planned_amount,project_expenses.amount",projects
Q0133,moderate,Top 5 vendors by total spend in 2022.,Use purchase_orders.total and vendor names.,"  SELECT v.name, SUM(po.total) AS total_spend
  FROM div_01.purchase_orders po
  JOIN div_01.vendors v ON v.vendor_id = po.vendor_id
  WHERE EXTRACT(YEAR FROM po.order_date) = 2022
  GROUP BY v.name
  ORDER BY total_spend DESC
  LIMIT 5;","purchase_orders,vendors","purchase_orders.total,purchase_orders.order_date,vendors.name",procurement
Q0134,moderate,Average days between vendor invoice date and due date by vendor.,Use vendor_invoices.invoice_date and due_date.,"  SELECT v.name, ROUND(AVG(vi.due_date - vi.invoice_date), 2) AS avg_days
  FROM div_01.vendor_invoices vi
  JOIN div_01.vendors v ON v.vendor_id = vi.vendor_id
  GROUP BY v.name;","vendor_invoices,vendors","vendor_invoices.invoice_date,vendor_invoices.due_date",procurement
Q0135,simple,Bank transaction totals by type for 2022.,Use bank_transactions.type.,"  SELECT type, SUM(amount) AS total_amount
  FROM div_01.bank_transactions
  WHERE EXTRACT(YEAR FROM date) = 2022
  GROUP BY type;",bank_transactions,"bank_transactions.type,bank_transactions.amount,bank_transactions.date",finance
Q0136,simple,List open AR invoices over 5000 in 2022.,AR invoices are in finance_ar_invoices.,"  SELECT ar_invoice_id, invoice_number, amount, status
  FROM div_01.finance_ar_invoices
  WHERE status = 'open'
    AND amount > 5000
    AND EXTRACT(YEAR FROM invoice_date) = 2022;",finance_ar_invoices,"finance_ar_invoices.amount,finance_ar_invoices.status,finance_ar_invoices.invoice_date","finance,ar"
Q0137,moderate,Total maintenance cost by asset category in 2022.,Join asset_maintenance -> fixed_assets -> asset_categories.,"  SELECT ac.name, SUM(am.cost) AS total_cost
  FROM div_01.asset_maintenance am
  JOIN div_01.fixed_assets fa ON fa.asset_id = am.asset_id
  JOIN div_01.asset_categories ac ON ac.category_id = fa.category_id
  WHERE EXTRACT(YEAR FROM am.scheduled_date) = 2022
  GROUP BY ac.name;","asset_maintenance,fixed_assets,asset_categories","asset_maintenance.cost,asset_categories.name",assets
Q0138,moderate,Products below reorder minimum by warehouse.,Join reorder_rules to inventory_levels.,"  SELECT w.warehouse_id, p.sku, il.quantity_on_hand, rr.min_quantity
  FROM div_01.reorder_rules rr
  JOIN div_01.inventory_levels il ON il.product_id = rr.product_id AND il.warehouse_id = rr.warehouse_id
  JOIN div_01.products p ON p.product_id = rr.product_id
  WHERE il.quantity_on_hand < rr.min_quantity;","reorder_rules,inventory_levels,products","reorder_rules.min_quantity,inventory_levels.quantity_on_hand",inventory
Q0139,moderate,Benefit election count by coverage level in 2024.,Use hr_benefit_elections.election_date.,"  SELECT coverage_level, COUNT(*) AS elections
  FROM div_01.hr_benefit_elections
  WHERE EXTRACT(YEAR FROM election_date) = 2024
  GROUP BY coverage_level;",hr_benefit_elections,"hr_benefit_elections.coverage_level,hr_benefit_elections.election_date","hr,benefits"
Q0140,challenging,Inventory turns by product category for 2021.,Approximate turns using inventory_transactions quantity.,"  SELECT pc.name, SUM(it.quantity) AS total_moved
  FROM div_01.inventory_transactions it
  JOIN div_01.products p ON p.product_id = it.product_id
  JOIN div_01.product_categories pc ON pc.category_id = p.category_id
  WHERE EXTRACT(YEAR FROM it.date) = 2021
  GROUP BY pc.name
  ORDER BY total_moved DESC;","inventory_transactions,products,product_categories","inventory_transactions.quantity,inventory_transactions.date,product_categories.name",inventory
Q0141,simple,Timesheets awaiting approval in 2023.,Use timesheets.status = 'submitted'.,"  SELECT timesheet_id, employee_id, week_start_date, status
  FROM div_01.timesheets
  WHERE status = 'submitted'
    AND EXTRACT(YEAR FROM week_start_date) = 2023;",timesheets,"timesheets.status,timesheets.week_start_date",projects
Q0142,moderate,Benefit election count by coverage level in 2024.,Use hr_benefit_elections.election_date.,"  SELECT coverage_level, COUNT(*) AS elections
  FROM div_01.hr_benefit_elections
  WHERE EXTRACT(YEAR FROM election_date) = 2024
  GROUP BY coverage_level;",hr_benefit_elections,"hr_benefit_elections.coverage_level,hr_benefit_elections.election_date","hr,benefits"
Q0143,moderate,Sales orders shipped after ship_date in 2024.,Use sales_orders.ship_date and order_date; assume ship_date is planned date.,"  SELECT order_id, customer_id, order_date, ship_date
  FROM div_01.sales_orders
  WHERE ship_date IS NOT NULL
    AND ship_date > order_date
    AND EXTRACT(YEAR FROM order_date) = 2024;",sales_orders,"sales_orders.ship_date,sales_orders.order_date",sales
Q0144,challenging,Average time to close support cases in 2024.,Closed cases have status = 'closed'; use opened_at vs updated_at.,"  SELECT ROUND(AVG(updated_at - opened_at), 2) AS avg_close_time
  FROM div_01.cust_srv_case
  WHERE status = 'closed'
    AND EXTRACT(YEAR FROM opened_at) = 2024;",cust_srv_case,"cust_srv_case.opened_at,cust_srv_case.updated_at",support
Q0145,simple,List bank accounts with balance under 1000.,Use bank_accounts.balance.,"  SELECT bank_account_id, account_number, bank_name, balance
  FROM div_01.bank_accounts
  WHERE balance < 1000;",bank_accounts,bank_accounts.balance,finance
Q0146,simple,Sales order counts by status for 2023.,Use sales_orders.status.,"  SELECT status, COUNT(*) AS order_count
  FROM div_01.sales_orders
  WHERE EXTRACT(YEAR FROM order_date) = 2023
  GROUP BY status;",sales_orders,"sales_orders.status,sales_orders.order_date",sales
Q0147,simple,Vendors with payment terms containing 'net 60'.,Use vendors.payment_terms.,"  SELECT vendor_id, name, payment_terms
  FROM div_01.vendors
  WHERE payment_terms ILIKE '%' || 'net 60' || '%';",vendors,vendors.payment_terms,procurement
Q0148,simple,List bank accounts with balance under 5000.,Use bank_accounts.balance.,"  SELECT bank_account_id, account_number, bank_name, balance
  FROM div_01.bank_accounts
  WHERE balance < 5000;",bank_accounts,bank_accounts.balance,finance
Q0149,simple,List open sales opportunities with probability over 0.8.,Use sales_opportunities.probability.,"  SELECT opportunity_id, name, amount, probability
  FROM div_01.sales_opportunities
  WHERE probability > 0.8;",sales_opportunities,sales_opportunities.probability,sales
Q0150,moderate,Total maintenance cost by asset category in 2024.,Join asset_maintenance -> fixed_assets -> asset_categories.,"  SELECT ac.name, SUM(am.cost) AS total_cost
  FROM div_01.asset_maintenance am
  JOIN div_01.fixed_assets fa ON fa.asset_id = am.asset_id
  JOIN div_01.asset_categories ac ON ac.category_id = fa.category_id
  WHERE EXTRACT(YEAR FROM am.scheduled_date) = 2024
  GROUP BY ac.name;","asset_maintenance,fixed_assets,asset_categories","asset_maintenance.cost,asset_categories.name",assets
Q0151,moderate,QC failure rate for inventory lots in 2021.,Fail results have result = 'fail'.,"  SELECT
    ROUND(100.0 * SUM(CASE WHEN qi.result = 'fail' THEN 1 ELSE 0 END) / COUNT(*), 2) AS fail_pct
  FROM div_01.inventory_qc_inspections qi
  WHERE EXTRACT(YEAR FROM qi.inspection_date) = 2021;","inventory_qc_inspections,inventory_lots","inventory_qc_inspections.result,inventory_qc_inspections.inspection_date","inventory,qc"
Q0152,moderate,Sales orders shipped after ship_date in 2021.,Use sales_orders.ship_date and order_date; assume ship_date is planned date.,"  SELECT order_id, customer_id, order_date, ship_date
  FROM div_01.sales_orders
  WHERE ship_date IS NOT NULL
    AND ship_date > order_date
    AND EXTRACT(YEAR FROM order_date) = 2021;",sales_orders,"sales_orders.ship_date,sales_orders.order_date",sales
Q0153,challenging,Quote-to-order conversion rate for 2024.,Join sales_quotes to sales_orders by customer and dates.,"  SELECT
    ROUND(100.0 * COUNT(DISTINCT so.order_id) / NULLIF(COUNT(DISTINCT sq.quote_id),0), 2) AS conversion_pct
  FROM div_01.sales_quotes sq
  LEFT JOIN div_01.sales_orders so ON so.customer_id = sq.customer_id
  WHERE EXTRACT(YEAR FROM sq.quote_date) = 2024;","sales_quotes,sales_orders","sales_quotes.quote_date,sales_orders.order_date",sales
Q0154,challenging,Employee utilization rate = hours logged / 40 by week in 2022.,Use timesheet_entries.hours.,"  SELECT e.employee_id, DATE_TRUNC('week', t.week_start_date) AS week_start,
         ROUND(SUM(te.hours) / 40.0, 2) AS utilization
  FROM div_01.timesheets t
  JOIN div_01.timesheet_entries te ON te.timesheet_id = t.timesheet_id
  JOIN div_01.employees e ON e.employee_id = t.employee_id
  WHERE EXTRACT(YEAR FROM t.week_start_date) = 2022
  GROUP BY e.employee_id, week_start;","timesheet_entries,timesheets,employees","timesheet_entries.hours,timesheets.week_start_date","projects,hr"
Q0155,moderate,Total depreciation by period for 2023.,Use depreciation_entries.period_id and amount.,"  SELECT fp.start_date, SUM(de.amount) AS total_depr
  FROM div_01.depreciation_entries de
  JOIN div_01.fiscal_periods fp ON fp.period_id = de.period_id
  WHERE EXTRACT(YEAR FROM fp.start_date) = 2023
  GROUP BY fp.start_date
  ORDER BY fp.start_date;","depreciation_entries,fiscal_periods","depreciation_entries.amount,fiscal_periods.start_date","assets,finance"
Q0156,moderate,Warehouse locations with low capacity (< 50).,Use warehouse_locations.capacity.,"  SELECT location_id, warehouse_id, aisle, rack, bin, capacity
  FROM div_01.warehouse_locations
  WHERE capacity < 50;",warehouse_locations,warehouse_locations.capacity,inventory
Q0157,challenging,Employee turnover rate for 2023.,Turnover = terminations / average headcount.,"  WITH terminations AS (
    SELECT COUNT(*) AS term_count
    FROM div_01.employees
    WHERE EXTRACT(YEAR FROM termination_date) = 2023
  ),
  headcount AS (
    SELECT COUNT(*) AS headcount
    FROM div_01.employees
    WHERE hire_date <= DATE '2023-12-31'
      AND (termination_date IS NULL OR termination_date > DATE '2023-01-01')
  )
  SELECT ROUND(100.0 * t.term_count / NULLIF(h.headcount,0), 2) AS turnover_pct
  FROM terminations t, headcount h;",employees,"employees.termination_date,employees.hire_date",hr
Q0158,moderate,Assets transferred between locations in 2022.,Use asset_transfers.transfer_date.,"  SELECT transfer_id, asset_id, from_location_id, to_location_id, transfer_date
  FROM div_01.asset_transfers
  WHERE EXTRACT(YEAR FROM transfer_date) = 2022;",asset_transfers,asset_transfers.transfer_date,assets
Q0159,moderate,Headcount by department for 2022.,Use employees.department_id.,"  SELECT d.name, COUNT(*) AS headcount
  FROM div_01.employees e
  JOIN div_01.departments d ON d.department_id = e.department_id
  WHERE EXTRACT(YEAR FROM e.hire_date) <= 2022
  GROUP BY d.name
  ORDER BY headcount DESC;","employees,departments",employees.department_id,hr
Q0160,moderate,Assets transferred between locations in 2022.,Use asset_transfers.transfer_date.,"  SELECT transfer_id, asset_id, from_location_id, to_location_id, transfer_date
  FROM div_01.asset_transfers
  WHERE EXTRACT(YEAR FROM transfer_date) = 2022;",asset_transfers,asset_transfers.transfer_date,assets
Q0161,simple,Number of journal entries by month in 2024.,Use journal_entries.entry_date.,"  SELECT DATE_TRUNC('month', entry_date) AS month, COUNT(*) AS entry_count
  FROM div_01.journal_entries
  WHERE EXTRACT(YEAR FROM entry_date) = 2024
  GROUP BY month
  ORDER BY month;",journal_entries,journal_entries.entry_date,finance
Q0162,simple,List open AR invoices over 5000 in 2024.,AR invoices are in finance_ar_invoices.,"  SELECT ar_invoice_id, invoice_number, amount, status
  FROM div_01.finance_ar_invoices
  WHERE status = 'open'
    AND amount > 5000
    AND EXTRACT(YEAR FROM invoice_date) = 2024;",finance_ar_invoices,"finance_ar_invoices.amount,finance_ar_invoices.status,finance_ar_invoices.invoice_date","finance,ar"
Q0163,simple,Number of comments per support case in 2021.,Use support_ticket_comments.comment_ts.,"  SELECT case_id, COUNT(*) AS comment_count
  FROM div_01.support_ticket_comments
  WHERE EXTRACT(YEAR FROM comment_ts) = 2021
  GROUP BY case_id;",support_ticket_comments,support_ticket_comments.comment_ts,support
Q0164,simple,Bank transaction totals by type for 2024.,Use bank_transactions.type.,"  SELECT type, SUM(amount) AS total_amount
  FROM div_01.bank_transactions
  WHERE EXTRACT(YEAR FROM date) = 2024
  GROUP BY type;",bank_transactions,"bank_transactions.type,bank_transactions.amount,bank_transactions.date",finance
Q0165,simple,Number of comments per support case in 2022.,Use support_ticket_comments.comment_ts.,"  SELECT case_id, COUNT(*) AS comment_count
  FROM div_01.support_ticket_comments
  WHERE EXTRACT(YEAR FROM comment_ts) = 2022
  GROUP BY case_id;",support_ticket_comments,support_ticket_comments.comment_ts,support
Q0166,challenging,Average days from requisition to PO for 2021.,Join purchase_requisitions to purchase_orders by requested_by (approx).,"  SELECT ROUND(AVG(po.order_date - pr.request_date), 2) AS avg_days
  FROM div_01.purchase_requisitions pr
  JOIN div_01.purchase_orders po ON po.created_by = pr.requested_by
  WHERE EXTRACT(YEAR FROM pr.request_date) = 2021;","purchase_requisitions,purchase_orders","purchase_requisitions.request_date,purchase_orders.order_date",procurement
Q0167,simple,Sales order counts by status for 2023.,Use sales_orders.status.,"  SELECT status, COUNT(*) AS order_count
  FROM div_01.sales_orders
  WHERE EXTRACT(YEAR FROM order_date) = 2023
  GROUP BY status;",sales_orders,"sales_orders.status,sales_orders.order_date",sales
Q0168,simple,Sales order counts by status for 2022.,Use sales_orders.status.,"  SELECT status, COUNT(*) AS order_count
  FROM div_01.sales_orders
  WHERE EXTRACT(YEAR FROM order_date) = 2022
  GROUP BY status;",sales_orders,"sales_orders.status,sales_orders.order_date",sales
Q0169,moderate,Count of open customer service cases by priority.,Use cust_srv_case; open/pending are not closed.,"  SELECT priority, COUNT(*) AS case_count
  FROM div_01.cust_srv_case
  WHERE status IN ('open','pending')
  GROUP BY priority;",cust_srv_case,"cust_srv_case.status,cust_srv_case.priority",support
Q0170,simple,List bank accounts with balance under 10000.,Use bank_accounts.balance.,"  SELECT bank_account_id, account_number, bank_name, balance
  FROM div_01.bank_accounts
  WHERE balance < 10000;",bank_accounts,bank_accounts.balance,finance
Q0171,moderate,Top 10 customers by total sales amount in 2023?,Use order date; 'total sales' = sum(order_lines.quantity * order_lines.unit_price).,"  SELECT c.name, SUM(ol.quantity * ol.unit_price) AS total_sales
  FROM div_01.sales_orders so
  JOIN div_01.order_lines ol ON ol.order_id = so.order_id
  JOIN div_01.customers c ON c.customer_id = so.customer_id
  WHERE EXTRACT(YEAR FROM so.order_date) = 2023
  GROUP BY c.name
  ORDER BY total_sales DESC
  LIMIT 10;","sales_orders,order_lines,customers","sales_orders.order_date,order_lines.quantity,order_lines.unit_price,customers.name","sales,top_n,aggregation"
Q0172,simple,Timesheets awaiting approval in 2022.,Use timesheets.status = 'submitted'.,"  SELECT timesheet_id, employee_id, week_start_date, status
  FROM div_01.timesheets
  WHERE status = 'submitted'
    AND EXTRACT(YEAR FROM week_start_date) = 2022;",timesheets,"timesheets.status,timesheets.week_start_date",projects
Q0173,simple,Sales order counts by status for 2022.,Use sales_orders.status.,"  SELECT status, COUNT(*) AS order_count
  FROM div_01.sales_orders
  WHERE EXTRACT(YEAR FROM order_date) = 2022
  GROUP BY status;",sales_orders,"sales_orders.status,sales_orders.order_date",sales
Q0174,simple,Customers with credit limit over 500.,Use customers.credit_limit.,"  SELECT customer_id, name, credit_limit
  FROM div_01.customers
  WHERE credit_limit > 500;",customers,customers.credit_limit,sales
Q0175,simple,Vendors with payment terms containing 'net 60'.,Use vendors.payment_terms.,"  SELECT vendor_id, name, payment_terms
  FROM div_01.vendors
  WHERE payment_terms ILIKE '%' || 'net 60' || '%';",vendors,vendors.payment_terms,procurement
Q0176,simple,List open AR invoices over 10000 in 2023.,AR invoices are in finance_ar_invoices.,"  SELECT ar_invoice_id, invoice_number, amount, status
  FROM div_01.finance_ar_invoices
  WHERE status = 'open'
    AND amount > 10000
    AND EXTRACT(YEAR FROM invoice_date) = 2023;",finance_ar_invoices,"finance_ar_invoices.amount,finance_ar_invoices.status,finance_ar_invoices.invoice_date","finance,ar"
Q0177,moderate,Average days between vendor invoice date and due date by vendor.,Use vendor_invoices.invoice_date and due_date.,"  SELECT v.name, ROUND(AVG(vi.due_date - vi.invoice_date), 2) AS avg_days
  FROM div_01.vendor_invoices vi
  JOIN div_01.vendors v ON v.vendor_id = vi.vendor_id
  GROUP BY v.name;","vendor_invoices,vendors","vendor_invoices.invoice_date,vendor_invoices.due_date",procurement
Q0178,simple,Bank transaction totals by type for 2022.,Use bank_transactions.type.,"  SELECT type, SUM(amount) AS total_amount
  FROM div_01.bank_transactions
  WHERE EXTRACT(YEAR FROM date) = 2022
  GROUP BY type;",bank_transactions,"bank_transactions.type,bank_transactions.amount,bank_transactions.date",finance
Q0179,moderate,Average allocation percent by project in 2022.,Use project_resources.allocation_percent.,"  SELECT p.name, ROUND(AVG(pr.allocation_percent), 2) AS avg_alloc
  FROM div_01.project_resources pr
  JOIN div_01.projects p ON p.project_id = pr.project_id
  WHERE EXTRACT(YEAR FROM p.start_date) = 2022
  GROUP BY p.name;","project_resources,projects","project_resources.allocation_percent,projects.start_date",projects
Q0180,moderate,What percentage of AR invoices were late in 2022?,Late invoices have status = 'late'.,"  SELECT
    ROUND(100.0 * SUM(CASE WHEN status = 'late' THEN 1 ELSE 0 END) / COUNT(*), 2) AS late_pct
  FROM div_01.finance_ar_invoices
  WHERE EXTRACT(YEAR FROM invoice_date) = 2022;",finance_ar_invoices,"finance_ar_invoices.status,finance_ar_invoices.invoice_date","finance,ar,rate"
Q0181,simple,Sales order counts by status for 2023.,Use sales_orders.status.,"  SELECT status, COUNT(*) AS order_count
  FROM div_01.sales_orders
  WHERE EXTRACT(YEAR FROM order_date) = 2023
  GROUP BY status;",sales_orders,"sales_orders.status,sales_orders.order_date",sales
Q0182,challenging,Average days between PO order date and goods receipt for each vendor in 2022.,Join purchase_orders -> goods_receipts -> vendors.,"  SELECT v.name, ROUND(AVG(gr.receipt_date - po.order_date), 2) AS avg_days
  FROM div_01.purchase_orders po
  JOIN div_01.goods_receipts gr ON gr.po_id = po.po_id
  JOIN div_01.vendors v ON v.vendor_id = po.vendor_id
  WHERE EXTRACT(YEAR FROM po.order_date) = 2022
  GROUP BY v.name
  ORDER BY avg_days;","purchase_orders,goods_receipts,vendors","purchase_orders.order_date,goods_receipts.receipt_date,vendors.name",procurement
Q0183,simple,List open AR invoices over 1000 in 2022.,AR invoices are in finance_ar_invoices.,"  SELECT ar_invoice_id, invoice_number, amount, status
  FROM div_01.finance_ar_invoices
  WHERE status = 'open'
    AND amount > 1000
    AND EXTRACT(YEAR FROM invoice_date) = 2022;",finance_ar_invoices,"finance_ar_invoices.amount,finance_ar_invoices.status,finance_ar_invoices.invoice_date","finance,ar"
Q0184,moderate,Top 5 vendors by total spend in 2024.,Use purchase_orders.total and vendor names.,"  SELECT v.name, SUM(po.total) AS total_spend
  FROM div_01.purchase_orders po
  JOIN div_01.vendors v ON v.vendor_id = po.vendor_id
  WHERE EXTRACT(YEAR FROM po.order_date) = 2024
  GROUP BY v.name
  ORDER BY total_spend DESC
  LIMIT 5;","purchase_orders,vendors","purchase_orders.total,purchase_orders.order_date,vendors.name",procurement
Q0185,moderate,Top 10 customers by total sales amount in 2024?,Use order date; 'total sales' = sum(order_lines.quantity * order_lines.unit_price).,"  SELECT c.name, SUM(ol.quantity * ol.unit_price) AS total_sales
  FROM div_01.sales_orders so
  JOIN div_01.order_lines ol ON ol.order_id = so.order_id
  JOIN div_01.customers c ON c.customer_id = so.customer_id
  WHERE EXTRACT(YEAR FROM so.order_date) = 2024
  GROUP BY c.name
  ORDER BY total_sales DESC
  LIMIT 10;","sales_orders,order_lines,customers","sales_orders.order_date,order_lines.quantity,order_lines.unit_price,customers.name","sales,top_n,aggregation"
Q0186,moderate,Average allocation percent by project in 2022.,Use project_resources.allocation_percent.,"  SELECT p.name, ROUND(AVG(pr.allocation_percent), 2) AS avg_alloc
  FROM div_01.project_resources pr
  JOIN div_01.projects p ON p.project_id = pr.project_id
  WHERE EXTRACT(YEAR FROM p.start_date) = 2022
  GROUP BY p.name;","project_resources,projects","project_resources.allocation_percent,projects.start_date",projects
Q0187,challenging,Employee utilization rate = hours logged / 40 by week in 2024.,Use timesheet_entries.hours.,"  SELECT e.employee_id, DATE_TRUNC('week', t.week_start_date) AS week_start,
         ROUND(SUM(te.hours) / 40.0, 2) AS utilization
  FROM div_01.timesheets t
  JOIN div_01.timesheet_entries te ON te.timesheet_id = t.timesheet_id
  JOIN div_01.employees e ON e.employee_id = t.employee_id
  WHERE EXTRACT(YEAR FROM t.week_start_date) = 2024
  GROUP BY e.employee_id, week_start;","timesheet_entries,timesheets,employees","timesheet_entries.hours,timesheets.week_start_date","projects,hr"
Q0188,moderate,Employees with more than 10 time clock entries in a week during 2023.,Use hr_time_clock_entries.work_date; count per week.,"  SELECT e.employee_id, e.first_name, e.last_name, DATE_TRUNC('week', t.work_date) AS week_start, COUNT(*) AS entries
  FROM div_01.hr_time_clock_entries t
  JOIN div_01.employees e ON e.employee_id = t.employee_id
  WHERE EXTRACT(YEAR FROM t.work_date) = 2023
  GROUP BY e.employee_id, e.first_name, e.last_name, week_start
  HAVING COUNT(*) > 10;","hr_time_clock_entries,employees","hr_time_clock_entries.work_date,employees.employee_id","hr,time"
Q0189,simple,Show onboarding tasks overdue as of today.,Overdue if status not done and due_date < today.,"  SELECT task_id, employee_id, task_name, due_date, status
  FROM div_01.hr_onboarding_tasks
  WHERE status <> 'done'
    AND due_date < CURRENT_DATE;",hr_onboarding_tasks,"hr_onboarding_tasks.status,hr_onboarding_tasks.due_date",hr
Q0190,simple,Customers with credit limit over 5000.,Use customers.credit_limit.,"  SELECT customer_id, name, credit_limit
  FROM div_01.customers
  WHERE credit_limit > 5000;",customers,customers.credit_limit,sales
Q0191,moderate,QC failure rate for inventory lots in 2022.,Fail results have result = 'fail'.,"  SELECT
    ROUND(100.0 * SUM(CASE WHEN qi.result = 'fail' THEN 1 ELSE 0 END) / COUNT(*), 2) AS fail_pct
  FROM div_01.inventory_qc_inspections qi
  WHERE EXTRACT(YEAR FROM qi.inspection_date) = 2022;","inventory_qc_inspections,inventory_lots","inventory_qc_inspections.result,inventory_qc_inspections.inspection_date","inventory,qc"
Q0192,simple,Number of journal entries by month in 2024.,Use journal_entries.entry_date.,"  SELECT DATE_TRUNC('month', entry_date) AS month, COUNT(*) AS entry_count
  FROM div_01.journal_entries
  WHERE EXTRACT(YEAR FROM entry_date) = 2024
  GROUP BY month
  ORDER BY month;",journal_entries,journal_entries.entry_date,finance
Q0193,moderate,Total AP invoice amount by vendor for 2023.,Join finance_ap_invoices to vendors.,"  SELECT v.name, SUM(ai.amount) AS total_amount
  FROM div_01.finance_ap_invoices ai
  JOIN div_01.vendors v ON v.vendor_id = ai.vendor_id
  WHERE EXTRACT(YEAR FROM ai.invoice_date) = 2023
  GROUP BY v.name
  ORDER BY total_amount DESC;","finance_ap_invoices,vendors","finance_ap_invoices.amount,finance_ap_invoices.invoice_date,vendors.name","finance,ap"
Q0194,moderate,Total depreciation by period for 2024.,Use depreciation_entries.period_id and amount.,"  SELECT fp.start_date, SUM(de.amount) AS total_depr
  FROM div_01.depreciation_entries de
  JOIN div_01.fiscal_periods fp ON fp.period_id = de.period_id
  WHERE EXTRACT(YEAR FROM fp.start_date) = 2024
  GROUP BY fp.start_date
  ORDER BY fp.start_date;","depreciation_entries,fiscal_periods","depreciation_entries.amount,fiscal_periods.start_date","assets,finance"
Q0195,moderate,Warehouse locations with low capacity (< 250).,Use warehouse_locations.capacity.,"  SELECT location_id, warehouse_id, aisle, rack, bin, capacity
  FROM div_01.warehouse_locations
  WHERE capacity < 250;",warehouse_locations,warehouse_locations.capacity,inventory
Q0196,challenging,Quote-to-order conversion rate for 2023.,Join sales_quotes to sales_orders by customer and dates.,"  SELECT
    ROUND(100.0 * COUNT(DISTINCT so.order_id) / NULLIF(COUNT(DISTINCT sq.quote_id),0), 2) AS conversion_pct
  FROM div_01.sales_quotes sq
  LEFT JOIN div_01.sales_orders so ON so.customer_id = sq.customer_id
  WHERE EXTRACT(YEAR FROM sq.quote_date) = 2023;","sales_quotes,sales_orders","sales_quotes.quote_date,sales_orders.order_date",sales
Q0197,moderate,Average allocation percent by project in 2021.,Use project_resources.allocation_percent.,"  SELECT p.name, ROUND(AVG(pr.allocation_percent), 2) AS avg_alloc
  FROM div_01.project_resources pr
  JOIN div_01.projects p ON p.project_id = pr.project_id
  WHERE EXTRACT(YEAR FROM p.start_date) = 2021
  GROUP BY p.name;","project_resources,projects","project_resources.allocation_percent,projects.start_date",projects
Q0198,moderate,Open opportunities by stage for 2023.,Join sales_opportunities to opportunity_stages.,"  SELECT os.name, COUNT(*) AS opportunity_count
  FROM div_01.sales_opportunities so
  JOIN div_01.opportunity_stages os ON os.stage_id = so.stage_id
  WHERE EXTRACT(YEAR FROM so.close_date) = 2023
  GROUP BY os.name;","sales_opportunities,opportunity_stages","sales_opportunities.close_date,opportunity_stages.name",sales
Q0199,moderate,Top 10 customers by total sales amount in 2021?,Use order date; 'total sales' = sum(order_lines.quantity * order_lines.unit_price).,"  SELECT c.name, SUM(ol.quantity * ol.unit_price) AS total_sales
  FROM div_01.sales_orders so
  JOIN div_01.order_lines ol ON ol.order_id = so.order_id
  JOIN div_01.customers c ON c.customer_id = so.customer_id
  WHERE EXTRACT(YEAR FROM so.order_date) = 2021
  GROUP BY c.name
  ORDER BY total_sales DESC
  LIMIT 10;","sales_orders,order_lines,customers","sales_orders.order_date,order_lines.quantity,order_lines.unit_price,customers.name","sales,top_n,aggregation"
Q0200,moderate,Total journal line amounts by cost center for 2021.,Use journal_lines.debit and credit.,"  SELECT cc.name, SUM(jl.debit - jl.credit) AS net_amount
  FROM div_01.journal_lines jl
  JOIN div_01.journal_entries je ON je.entry_id = jl.entry_id
  JOIN div_01.cost_centers cc ON cc.cost_center_id = jl.cost_center_id
  WHERE EXTRACT(YEAR FROM je.entry_date) = 2021
  GROUP BY cc.name;","journal_lines,cost_centers,journal_entries","journal_lines.debit,journal_lines.credit,journal_entries.entry_date",finance
