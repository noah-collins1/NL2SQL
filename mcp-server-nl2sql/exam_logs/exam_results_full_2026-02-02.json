{
  "summary": {
    "total": 60,
    "success_rate": "65.0",
    "by_difficulty": {
      "easy": {
        "pass": 19,
        "fail": 1
      },
      "medium": {
        "pass": 15,
        "fail": 10
      },
      "hard": {
        "pass": 5,
        "fail": 10
      }
    },
    "by_module": {
      "HR": {
        "pass": 12,
        "fail": 2
      },
      "Sales": {
        "pass": 5,
        "fail": 6
      },
      "Inventory": {
        "pass": 4,
        "fail": 4
      },
      "Procurement": {
        "pass": 2,
        "fail": 3
      },
      "Finance": {
        "pass": 6,
        "fail": 2
      },
      "Projects": {
        "pass": 4,
        "fail": 2
      },
      "Assets": {
        "pass": 4,
        "fail": 1
      },
      "Common": {
        "pass": 2,
        "fail": 0
      },
      "Cross-Module": {
        "pass": 0,
        "fail": 1
      }
    },
    "failure_counts": {
      "retrieval_miss": 0,
      "join_path_miss": 1,
      "column_miss": 9,
      "value_miss": 0,
      "llm_reasoning": 10,
      "execution_error": 1,
      "success": 39
    }
  },
  "results": [
    {
      "id": 1,
      "difficulty": "easy",
      "module": "HR",
      "question": "List all employees in the Sales department",
      "tables_needed": [
        "employees",
        "departments"
      ],
      "retrieved_tables": [
        "departments",
        "departments",
        "departments",
        "employees",
        "employees",
        "employees",
        "positions",
        "positions",
        "positions",
        "employee_salaries",
        "employee_salaries",
        "employee_salaries",
        "sales_regions",
        "business_units",
        "business_units"
      ],
      "sql_generated": "SELECT e.employee_id, e.first_name, e.last_name FROM employees e JOIN departments d ON e.department_id = d.department_id WHERE d.name = 'Sales' LIMIT 1000;",
      "success": true,
      "latency_ms": 6151,
      "retrieval_miss": [],
      "extra_tables": [
        "positions",
        "positions",
        "positions",
        "employee_salaries",
        "employee_salaries",
        "employee_salaries",
        "sales_regions",
        "business_units",
        "business_units"
      ]
    },
    {
      "id": 2,
      "difficulty": "easy",
      "module": "HR",
      "question": "How many employees were hired in 2024?",
      "tables_needed": [
        "employees"
      ],
      "retrieved_tables": [
        "employees",
        "employees",
        "employees",
        "employment_history",
        "employee_salaries",
        "employee_salaries",
        "employee_salaries",
        "employee_certifications",
        "employment_history",
        "employment_history",
        "timesheets",
        "employee_certifications",
        "employee_certifications",
        "sales_regions",
        "purchase_requisitions"
      ],
      "sql_generated": "SELECT COUNT(*) FROM employees WHERE hire_date BETWEEN '2024-01-01' AND '2024-12-31' LIMIT 1000;",
      "success": true,
      "latency_ms": 5348,
      "retrieval_miss": [],
      "extra_tables": [
        "employment_history",
        "employee_salaries",
        "employee_salaries",
        "employee_salaries",
        "employee_certifications",
        "employment_history",
        "employment_history",
        "timesheets",
        "employee_certifications",
        "employee_certifications",
        "sales_regions",
        "purchase_requisitions"
      ]
    },
    {
      "id": 3,
      "difficulty": "easy",
      "module": "HR",
      "question": "What is the average salary by department?",
      "tables_needed": [
        "employees",
        "departments"
      ],
      "retrieved_tables": [
        "positions",
        "positions",
        "positions",
        "employee_salaries",
        "employee_salaries",
        "employee_salaries",
        "departments",
        "departments",
        "departments",
        "employees",
        "employees",
        "employees",
        "cost_centers",
        "budgets",
        "cost_centers"
      ],
      "sql_generated": "SELECT d.name AS department_name, AVG(e.salary) AS avg_salary FROM departments d LEFT JOIN employees e ON d.department_id = e.department_id GROUP BY d.name LIMIT 1000;",
      "success": true,
      "latency_ms": 2241,
      "retrieval_miss": [],
      "extra_tables": [
        "positions",
        "positions",
        "positions",
        "employee_salaries",
        "employee_salaries",
        "employee_salaries",
        "cost_centers",
        "budgets",
        "cost_centers"
      ]
    },
    {
      "id": 4,
      "difficulty": "easy",
      "module": "Sales",
      "question": "List all customers with credit limit over $100,000",
      "tables_needed": [
        "customers"
      ],
      "retrieved_tables": [
        "customers",
        "customers",
        "customers",
        "customer_contacts",
        "sales_regions",
        "customer_contacts",
        "customer_contacts",
        "certifications",
        "sales_quotes",
        "purchase_requisitions",
        "purchase_requisitions",
        "purchase_requisitions",
        "budget_lines",
        "sales_regions",
        "sales_regions"
      ],
      "sql_generated": "SELECT customers.customer_id, customers.name FROM customers WHERE customers.credit_limit > 100000;",
      "success": true,
      "latency_ms": 5175,
      "retrieval_miss": [],
      "extra_tables": [
        "customer_contacts",
        "sales_regions",
        "customer_contacts",
        "customer_contacts",
        "certifications",
        "sales_quotes",
        "purchase_requisitions",
        "purchase_requisitions",
        "purchase_requisitions",
        "budget_lines",
        "sales_regions",
        "sales_regions"
      ]
    },
    {
      "id": 5,
      "difficulty": "easy",
      "module": "Sales",
      "question": "How many sales orders are in pending status?",
      "tables_needed": [
        "sales_orders"
      ],
      "retrieved_tables": [
        "sales_orders",
        "sales_orders",
        "sales_orders",
        "purchase_orders",
        "purchase_orders",
        "purchase_orders",
        "order_lines",
        "order_lines",
        "order_lines",
        "sales_opportunities",
        "sales_opportunities",
        "vendor_invoices",
        "goods_receipts",
        "sales_opportunities",
        "vendor_invoices"
      ],
      "sql_generated": "SELECT COUNT(*) as total_pending_orders FROM sales_orders s JOIN employees e ON s.sales_rep_id = e.employee_id WHERE s.status = 'Pending'; ### Candidate 2 SELECT COUNT(*) as total_pending_orders FROM sales_orders s JOIN customers c ON s.customer_id = c.customer_id WHERE s.status = 'Pending'; ### SQL_Candidate--- ### Candidate--- ### Context to the context",
      "success": false,
      "error_type": "validation",
      "error_message": "Multiple statements detected (separated by semicolons)",
      "latency_ms": 2383,
      "retrieval_miss": [],
      "extra_tables": [
        "purchase_orders",
        "purchase_orders",
        "purchase_orders",
        "order_lines",
        "order_lines",
        "order_lines",
        "sales_opportunities",
        "sales_opportunities",
        "vendor_invoices",
        "goods_receipts",
        "sales_opportunities",
        "vendor_invoices"
      ]
    },
    {
      "id": 6,
      "difficulty": "easy",
      "module": "Inventory",
      "question": "List all products in the Electronics category",
      "tables_needed": [
        "products",
        "product_categories"
      ],
      "retrieved_tables": [
        "product_categories",
        "product_categories",
        "product_categories",
        "products",
        "products",
        "products",
        "asset_categories",
        "asset_categories",
        "asset_categories",
        "product_suppliers",
        "product_suppliers",
        "product_suppliers",
        "inventory_levels",
        "benefit_types",
        "benefit_types"
      ],
      "sql_generated": "SELECT p.name AS product_name, p.description AS description FROM products p INNER JOIN product_categories pc ON p.category_id = pc.category_id WHERE pc.name = 'Electronics' LIMIT 1000;",
      "success": true,
      "latency_ms": 5712,
      "retrieval_miss": [],
      "extra_tables": [
        "asset_categories",
        "asset_categories",
        "asset_categories",
        "product_suppliers",
        "product_suppliers",
        "product_suppliers",
        "inventory_levels",
        "benefit_types",
        "benefit_types"
      ]
    },
    {
      "id": 7,
      "difficulty": "easy",
      "module": "Inventory",
      "question": "What are the names of all warehouses?",
      "tables_needed": [
        "warehouses"
      ],
      "retrieved_tables": [
        "warehouse_locations",
        "warehouse_locations",
        "warehouse_locations",
        "warehouses",
        "warehouses",
        "warehouses",
        "asset_locations",
        "asset_locations",
        "inventory_levels",
        "stock_transfers",
        "inventory_levels",
        "inventory_levels",
        "asset_locations",
        "stock_transfers",
        "stock_transfers"
      ],
      "sql_generated": "SELECT w.name FROM warehouses w LIMIT 1000;",
      "success": true,
      "latency_ms": 2659,
      "retrieval_miss": [],
      "extra_tables": [
        "warehouse_locations",
        "warehouse_locations",
        "warehouse_locations",
        "asset_locations",
        "asset_locations",
        "inventory_levels",
        "stock_transfers",
        "inventory_levels",
        "inventory_levels",
        "asset_locations",
        "stock_transfers",
        "stock_transfers"
      ]
    },
    {
      "id": 8,
      "difficulty": "easy",
      "module": "Procurement",
      "question": "List all active vendors",
      "tables_needed": [
        "vendors"
      ],
      "retrieved_tables": [
        "vendors",
        "vendors",
        "vendors",
        "vendor_contacts",
        "vendor_contacts",
        "vendor_invoices",
        "vendor_contacts",
        "vendor_invoices",
        "vendor_invoices",
        "product_suppliers",
        "product_suppliers",
        "product_suppliers",
        "vendor_invoice_lines",
        "vendor_invoice_lines",
        "purchase_orders"
      ],
      "sql_generated": "SELECT v.vendor_id, v.name FROM vendors v LIMIT 1000;",
      "success": true,
      "latency_ms": 4003,
      "retrieval_miss": [],
      "extra_tables": [
        "vendor_contacts",
        "vendor_contacts",
        "vendor_invoices",
        "vendor_contacts",
        "vendor_invoices",
        "vendor_invoices",
        "product_suppliers",
        "product_suppliers",
        "product_suppliers",
        "vendor_invoice_lines",
        "vendor_invoice_lines",
        "purchase_orders"
      ]
    },
    {
      "id": 9,
      "difficulty": "easy",
      "module": "Finance",
      "question": "What are the different account types in the chart of accounts?",
      "tables_needed": [
        "account_types"
      ],
      "retrieved_tables": [
        "chart_of_accounts",
        "account_types",
        "account_types",
        "account_types",
        "chart_of_accounts",
        "chart_of_accounts",
        "bank_accounts",
        "bank_accounts",
        "bank_accounts",
        "benefit_types",
        "benefit_types",
        "journal_lines",
        "asset_categories",
        "benefit_types",
        "bank_transactions"
      ],
      "sql_generated": "SELECT name FROM account_types LIMIT 1000;",
      "success": true,
      "latency_ms": 2363,
      "retrieval_miss": [],
      "extra_tables": [
        "chart_of_accounts",
        "chart_of_accounts",
        "chart_of_accounts",
        "bank_accounts",
        "bank_accounts",
        "bank_accounts",
        "benefit_types",
        "benefit_types",
        "journal_lines",
        "asset_categories",
        "benefit_types",
        "bank_transactions"
      ]
    },
    {
      "id": 10,
      "difficulty": "easy",
      "module": "Finance",
      "question": "List all bank accounts and their current balances",
      "tables_needed": [
        "bank_accounts"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT b.account_number, b.bank_name, b.current_balance FROM bank_accounts b LIMIT 1000;",
      "success": true,
      "latency_ms": 6248,
      "retrieval_miss": [
        "bank_accounts"
      ],
      "extra_tables": []
    },
    {
      "id": 11,
      "difficulty": "easy",
      "module": "Projects",
      "question": "How many projects are currently active?",
      "tables_needed": [
        "projects"
      ],
      "retrieved_tables": [
        "project_tasks",
        "project_tasks",
        "project_tasks",
        "project_phases",
        "project_phases",
        "projects",
        "projects",
        "project_milestones",
        "project_phases",
        "project_milestones",
        "project_milestones",
        "projects",
        "project_resources",
        "project_resources",
        "project_resources"
      ],
      "sql_generated": "SELECT COUNT(*) FROM projects WHERE status = 'active' AND created_at >= NOW() - INTERVAL '30 days' LIMIT 1000;",
      "success": true,
      "latency_ms": 4110,
      "retrieval_miss": [],
      "extra_tables": [
        "project_tasks",
        "project_tasks",
        "project_tasks",
        "project_phases",
        "project_phases",
        "project_milestones",
        "project_phases",
        "project_milestones",
        "project_milestones",
        "project_resources",
        "project_resources",
        "project_resources"
      ]
    },
    {
      "id": 12,
      "difficulty": "easy",
      "module": "Assets",
      "question": "List all fixed assets with their purchase cost",
      "tables_needed": [
        "fixed_assets"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT fa.asset_id, fa.name, fa.purchase_cost FROM fixed_assets AS fa LIMIT 1000;",
      "success": true,
      "latency_ms": 4683,
      "retrieval_miss": [
        "fixed_assets"
      ],
      "extra_tables": []
    },
    {
      "id": 13,
      "difficulty": "easy",
      "module": "HR",
      "question": "What are all the available leave types?",
      "tables_needed": [
        "leave_types"
      ],
      "retrieved_tables": [
        "leave_types",
        "leave_types",
        "leave_types",
        "leave_requests",
        "leave_requests",
        "leave_requests",
        "maintenance_types",
        "maintenance_types",
        "maintenance_types",
        "benefit_types",
        "benefit_types",
        "benefit_types",
        "account_types",
        "account_types",
        "account_types"
      ],
      "sql_generated": "SELECT lt.name AS leave_type_name FROM leave_types lt LIMIT 1000;",
      "success": true,
      "latency_ms": 3832,
      "retrieval_miss": [],
      "extra_tables": [
        "leave_requests",
        "leave_requests",
        "leave_requests",
        "maintenance_types",
        "maintenance_types",
        "maintenance_types",
        "benefit_types",
        "benefit_types",
        "benefit_types",
        "account_types",
        "account_types",
        "account_types"
      ]
    },
    {
      "id": 14,
      "difficulty": "easy",
      "module": "HR",
      "question": "List all training courses that are mandatory",
      "tables_needed": [
        "training_courses"
      ],
      "retrieved_tables": [
        "training_courses",
        "training_courses",
        "training_courses",
        "employee_training",
        "employee_training",
        "employee_training",
        "certifications",
        "certifications",
        "certifications",
        "employee_certifications",
        "employee_certifications",
        "employee_certifications",
        "maintenance_types",
        "maintenance_types",
        "maintenance_types"
      ],
      "sql_generated": "SELECT tc.name AS course_name, tc.duration_hours, tc.cost, tc.is_mandatory FROM training_courses tc WHERE tc.is_active = TRUE LIMIT 1000;",
      "success": true,
      "latency_ms": 6510,
      "retrieval_miss": [],
      "extra_tables": [
        "employee_training",
        "employee_training",
        "employee_training",
        "certifications",
        "certifications",
        "certifications",
        "employee_certifications",
        "employee_certifications",
        "employee_certifications",
        "maintenance_types",
        "maintenance_types",
        "maintenance_types"
      ]
    },
    {
      "id": 15,
      "difficulty": "easy",
      "module": "Sales",
      "question": "What are the different opportunity stages?",
      "tables_needed": [
        "opportunity_stages"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT stage.name FROM opportunity_stages AS stage LIMIT 1000;",
      "success": true,
      "latency_ms": 5355,
      "retrieval_miss": [
        "opportunity_stages"
      ],
      "extra_tables": []
    },
    {
      "id": 16,
      "difficulty": "easy",
      "module": "Common",
      "question": "List all countries in the system",
      "tables_needed": [
        "countries"
      ],
      "retrieved_tables": [
        "countries",
        "countries",
        "countries",
        "states_provinces",
        "states_provinces",
        "states_provinces",
        "tax_rates",
        "tax_rates",
        "tax_rates",
        "currencies",
        "currencies",
        "sales_territories",
        "sales_territories",
        "sales_territories",
        "currencies"
      ],
      "sql_generated": "SELECT name FROM countries LIMIT 1000;",
      "success": true,
      "latency_ms": 2709,
      "retrieval_miss": [],
      "extra_tables": [
        "states_provinces",
        "states_provinces",
        "states_provinces",
        "tax_rates",
        "tax_rates",
        "tax_rates",
        "currencies",
        "currencies",
        "sales_territories",
        "sales_territories",
        "sales_territories",
        "currencies"
      ]
    },
    {
      "id": 17,
      "difficulty": "easy",
      "module": "HR",
      "question": "How many departments are there?",
      "tables_needed": [
        "departments"
      ],
      "retrieved_tables": [
        "departments",
        "departments",
        "departments",
        "positions",
        "positions",
        "positions",
        "cost_centers",
        "inventory_levels",
        "cost_centers",
        "cost_centers",
        "budgets",
        "sales_territories",
        "employees",
        "sales_territories",
        "sales_territories"
      ],
      "sql_generated": "SELECT COUNT(*) FROM departments LIMIT 1000;",
      "success": true,
      "latency_ms": 1893,
      "retrieval_miss": [],
      "extra_tables": [
        "positions",
        "positions",
        "positions",
        "cost_centers",
        "inventory_levels",
        "cost_centers",
        "cost_centers",
        "budgets",
        "sales_territories",
        "employees",
        "sales_territories",
        "sales_territories"
      ]
    },
    {
      "id": 18,
      "difficulty": "easy",
      "module": "Inventory",
      "question": "List all units of measure",
      "tables_needed": [
        "units_of_measure"
      ],
      "retrieved_tables": [
        "units_of_measure",
        "units_of_measure",
        "units_of_measure",
        "products",
        "business_units",
        "products",
        "products",
        "business_units",
        "business_units",
        "currencies",
        "currencies",
        "currencies",
        "sales_regions",
        "sales_territories",
        "countries"
      ],
      "sql_generated": "SELECT uom.name AS unit_of_measure_name, uom.abbreviation AS abbreviation FROM units_of_measure uom LIMIT 1000;",
      "success": true,
      "latency_ms": 3707,
      "retrieval_miss": [],
      "extra_tables": [
        "products",
        "business_units",
        "products",
        "products",
        "business_units",
        "business_units",
        "currencies",
        "currencies",
        "currencies",
        "sales_regions",
        "sales_territories",
        "countries"
      ]
    },
    {
      "id": 19,
      "difficulty": "easy",
      "module": "Finance",
      "question": "What fiscal years exist in the system?",
      "tables_needed": [
        "fiscal_years"
      ],
      "retrieved_tables": [
        "fiscal_years",
        "fiscal_years",
        "fiscal_years",
        "fiscal_periods",
        "fiscal_periods",
        "fiscal_periods",
        "budgets",
        "budgets",
        "budgets",
        "journal_entries",
        "journal_entries",
        "journal_entries",
        "budget_lines",
        "budget_lines",
        "budget_lines"
      ],
      "sql_generated": "SELECT year FROM fiscal_years LIMIT 1000;",
      "success": true,
      "latency_ms": 2498,
      "retrieval_miss": [],
      "extra_tables": [
        "fiscal_periods",
        "fiscal_periods",
        "fiscal_periods",
        "budgets",
        "budgets",
        "budgets",
        "journal_entries",
        "journal_entries",
        "journal_entries",
        "budget_lines",
        "budget_lines",
        "budget_lines"
      ]
    },
    {
      "id": 20,
      "difficulty": "easy",
      "module": "Assets",
      "question": "What are the different asset categories?",
      "tables_needed": [
        "asset_categories"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT d.name FROM fixed_assets g JOIN asset_categories d ON g.category_id = d.category_id LIMIT 1000;",
      "success": true,
      "latency_ms": 3367,
      "retrieval_miss": [
        "asset_categories"
      ],
      "extra_tables": []
    },
    {
      "id": 21,
      "difficulty": "medium",
      "module": "HR",
      "question": "Find employees who have been with the company for more than 5 years and earn above $100,000",
      "tables_needed": [
        "employees"
      ],
      "retrieved_tables": [
        "employee_salaries",
        "employee_salaries",
        "employee_salaries",
        "employees",
        "employee_certifications",
        "employees",
        "employees",
        "employment_history",
        "employee_certifications",
        "employee_certifications",
        "employee_benefits",
        "sales_quotes",
        "employment_history",
        "employment_history",
        "project_expenses"
      ],
      "sql_generated": "SELECT e.employee_id, e.first_name || ' ' || e.last_name AS full_name FROM employees e WHERE e.salary > 100000 AND (e.hire_date <= CURRENT_DATE - INTERVAL '5 years') LIMIT 1000;",
      "success": true,
      "latency_ms": 6564,
      "retrieval_miss": [],
      "extra_tables": [
        "employee_salaries",
        "employee_salaries",
        "employee_salaries",
        "employee_certifications",
        "employment_history",
        "employee_certifications",
        "employee_certifications",
        "employee_benefits",
        "sales_quotes",
        "employment_history",
        "employment_history",
        "project_expenses"
      ]
    },
    {
      "id": 22,
      "difficulty": "medium",
      "module": "HR",
      "question": "List employees and their managers' names",
      "tables_needed": [
        "employees"
      ],
      "retrieved_tables": [
        "employees",
        "employees",
        "employees",
        "departments",
        "departments",
        "departments",
        "business_units",
        "business_units",
        "sales_regions",
        "sales_regions",
        "sales_regions",
        "business_units",
        "employee_salaries",
        "employment_history",
        "employee_salaries"
      ],
      "sql_generated": "SELECT e.employee_id, e.first_name || ' ' || e.last_name AS employee_full_name, m.first_name || ' ' || m.last_name AS manager_full_name FROM employees e JOIN employees m ON e.manager_id = m.employee_id LIMIT 1000;",
      "success": true,
      "latency_ms": 6732,
      "retrieval_miss": [],
      "extra_tables": [
        "departments",
        "departments",
        "departments",
        "business_units",
        "business_units",
        "sales_regions",
        "sales_regions",
        "sales_regions",
        "business_units",
        "employee_salaries",
        "employment_history",
        "employee_salaries"
      ]
    },
    {
      "id": 23,
      "difficulty": "medium",
      "module": "HR",
      "question": "Which employees have pending leave requests?",
      "tables_needed": [
        "employees",
        "leave_requests"
      ],
      "retrieved_tables": [
        "leave_requests",
        "leave_requests",
        "leave_requests",
        "leave_types",
        "leave_types",
        "employees",
        "leave_types",
        "employment_history",
        "employees",
        "employees",
        "employment_history",
        "employment_history",
        "purchase_requisitions",
        "purchase_requisitions",
        "purchase_requisitions"
      ],
      "sql_generated": "SELECT e.employee_id, e.first_name, e.last_name FROM employees e LEFT JOIN leave_requests lr ON e.employee_id = lr.employee_id WHERE lr.status = 'pending' LIMIT 1000;",
      "success": true,
      "latency_ms": 4402,
      "retrieval_miss": [],
      "extra_tables": [
        "leave_types",
        "leave_types",
        "leave_types",
        "employment_history",
        "employment_history",
        "employment_history",
        "purchase_requisitions",
        "purchase_requisitions",
        "purchase_requisitions"
      ]
    },
    {
      "id": 24,
      "difficulty": "medium",
      "module": "HR",
      "question": "Show the number of employees per position title",
      "tables_needed": [
        "employees",
        "positions"
      ],
      "retrieved_tables": [
        "positions",
        "positions",
        "positions",
        "employee_salaries",
        "employee_salaries",
        "employee_salaries",
        "employees",
        "sales_territories",
        "employees",
        "employees",
        "sales_territories",
        "sales_territories",
        "sales_regions",
        "sales_regions",
        "sales_regions"
      ],
      "sql_generated": "SELECT p.title, COUNT(e.employee_id) AS num_employees FROM positions p LEFT JOIN employees e ON p.position_id = e.position_id GROUP BY p.title LIMIT 1000;",
      "success": true,
      "latency_ms": 5830,
      "retrieval_miss": [],
      "extra_tables": [
        "employee_salaries",
        "employee_salaries",
        "employee_salaries",
        "sales_territories",
        "sales_territories",
        "sales_territories",
        "sales_regions",
        "sales_regions",
        "sales_regions"
      ]
    },
    {
      "id": 25,
      "difficulty": "medium",
      "module": "HR",
      "question": "Find employees with expiring certifications in the next 6 months",
      "tables_needed": [
        "employees",
        "employee_certifications",
        "certifications"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT DISTINCT e.employee_number || ' ' || e.first_name AS employee_full_name FROM employees e JOIN employee_certifications ec ON e.employee 1 JOIN certifications c ON ec.certification_id = c.certification_id WHERE ec.expiry_date BETWEEN CURRENT_DATE AND (CURRENT_DATE + INTERVAL '6 months') AND ec.status = 'active' GROUP BY e.first_name, e.last_name LIMIT 1000;",
      "success": false,
      "error_type": "execution",
      "error_message": "Database error after 3 attempts: syntax error at or near \"1\"",
      "sqlstate": "42601",
      "latency_ms": 16725,
      "retrieval_miss": [
        "employees",
        "employee_certifications",
        "certifications"
      ],
      "extra_tables": []
    },
    {
      "id": 26,
      "difficulty": "medium",
      "module": "Sales",
      "question": "What is the total sales amount by customer for 2024?",
      "tables_needed": [
        "customers",
        "sales_orders"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT c.customer_id AS customer_id, SUM(sales_orders.subtotal) AS total_sales FROM sales_orders JOIN customers ON sales_orders.customer_id = customers.customer_id WHERE EXTRACT(YEAR FROM sales_orders.order_date) = 2024 GROUP BY c.customer_id;",
      "success": false,
      "error_type": "validation",
      "error_message": "Failed to generate valid SQL after 3 attempts",
      "latency_ms": 7337,
      "retrieval_miss": [
        "customers",
        "sales_orders"
      ],
      "extra_tables": []
    },
    {
      "id": 27,
      "difficulty": "medium",
      "module": "Sales",
      "question": "List the top 10 customers by total order value",
      "tables_needed": [
        "customers",
        "sales_orders"
      ],
      "retrieved_tables": [
        "sales_orders",
        "order_lines",
        "purchase_orders",
        "sales_orders",
        "sales_orders",
        "order_lines",
        "order_lines",
        "purchase_orders",
        "purchase_orders",
        "customers",
        "customers",
        "customers",
        "product_suppliers",
        "vendor_invoices",
        "customer_contacts"
      ],
      "sql_generated": "SELECT c.name, SUM(po.total) as total_order_value FROM customers c INNER JOIN sales_orders so INNER JOIN order_lines ol ON so.customer_id = c.customer_id GROUP BY c.name ORDER BY total_order_value DESC LIMIT 10; ### Candidate 2 SELECT c.name, SUM(po.total) as total_order_value FROM customers c INNER JOIN sales_orders so INNER JOIN order_lines ol INNER SQL_Candidate 3 SELECT c.customer_id INNER_Candidate 4 UNION ALLERelation_table_schema. You are a text-based on the following schema_table_schema. You are a chatbot. You are a SQL_table. Your task. You are a database. You are a table. You are a SQL_table. You are a SQL_table. You are a SQL. You are a text. You are a text. ##. You are a text. You. You. You. You. response. You. You. Your. You are a text. You. You. You. . You. . You. . You. This. You. You. . You. You. You. You. You. You. You. You. You. You. You. You. You. You. You. You. You. You. You. You. You. You. You. You. You. You. You. You. Answer. . This. You. Your. You. You. You. . You. You. ##enhanced tables. You. The table. You. You.table. You. Identified. You. You. You. You. You.context. You. You. You. You. You. You. You. You. You. You. You. You. You. You. You. You. You. Context. Text. More. You. You. You. You. Input. You. You. Yourtext.context. You. You. You. You. You. You. You.context. You. You. Youa. Ascii. You. to answer. Answer.sql. For text. Context. Text. You. Identified. Here fores. This inserted. You. You. You. You. You. Your context. You. You. To identify.text. Many more tables. data. vea. You are. Yourelect. . Youare. item. Text, and the column.",
      "success": false,
      "error_type": "validation",
      "error_message": "Multiple statements detected (separated by semicolons)",
      "latency_ms": 8628,
      "retrieval_miss": [],
      "extra_tables": [
        "order_lines",
        "purchase_orders",
        "order_lines",
        "order_lines",
        "purchase_orders",
        "purchase_orders",
        "product_suppliers",
        "vendor_invoices",
        "customer_contacts"
      ]
    },
    {
      "id": 28,
      "difficulty": "medium",
      "module": "Sales",
      "question": "Show sales opportunities in the Negotiation stage worth over $50,000",
      "tables_needed": [
        "sales_opportunities",
        "opportunity_stages",
        "customers"
      ],
      "retrieved_tables": [
        "sales_opportunities",
        "sales_opportunities",
        "sales_opportunities",
        "opportunity_stages",
        "opportunity_stages",
        "opportunity_stages",
        "sales_quotes",
        "sales_quotes",
        "sales_quotes",
        "sales_orders",
        "sales_orders",
        "sales_regions",
        "sales_regions",
        "sales_orders",
        "sales_regions"
      ],
      "sql_generated": "SELECT s.name, s.amount FROM sales_opportunities s WHERE s.stage_id = (SELECT stage_id FROM opportunity_stages ORDER BY name LIMIT 1) AND s.amount > 50000;",
      "success": true,
      "latency_ms": 5653,
      "retrieval_miss": [
        "customers"
      ],
      "extra_tables": [
        "sales_quotes",
        "sales_quotes",
        "sales_quotes",
        "sales_orders",
        "sales_orders",
        "sales_regions",
        "sales_regions",
        "sales_orders",
        "sales_regions"
      ]
    },
    {
      "id": 29,
      "difficulty": "medium",
      "module": "Sales",
      "question": "What is the conversion rate from quotes to orders?",
      "tables_needed": [
        "sales_quotes",
        "sales_orders"
      ],
      "retrieved_tables": [
        "quote_lines",
        "sales_orders",
        "quote_lines",
        "quote_lines",
        "sales_quotes",
        "sales_quotes",
        "sales_quotes",
        "order_lines",
        "sales_orders",
        "sales_orders",
        "order_lines",
        "order_lines",
        "purchase_orders",
        "po_lines",
        "purchase_orders"
      ],
      "sql_generated": "SELECT (COUNT(DISTINCT o.order_id) * 100.0 / COUNT(DISTINCT q.quote_id)) AS conversion_rate FROM sales_quotes AS q JOIN sales_orders AS o ON q.quote_id = o.quote_id LIMIT 1000;",
      "success": true,
      "latency_ms": 2248,
      "retrieval_miss": [],
      "extra_tables": [
        "quote_lines",
        "quote_lines",
        "quote_lines",
        "order_lines",
        "order_lines",
        "order_lines",
        "purchase_orders",
        "po_lines",
        "purchase_orders"
      ]
    },
    {
      "id": 30,
      "difficulty": "medium",
      "module": "Sales",
      "question": "List sales orders by sales representative with their totals",
      "tables_needed": [
        "sales_orders",
        "employees"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT sr.name AS SalesRepName, SUM(sales_orders.total) AS TotalSales FROM sales_orders JOIN employees AS sr ON sales_orders.sales_rep_id = sr.employee_id GROUP BY sr.name;",
      "success": false,
      "error_type": "validation",
      "error_message": "Failed to generate valid SQL after 3 attempts",
      "latency_ms": 15558,
      "retrieval_miss": [
        "sales_orders",
        "employees"
      ],
      "extra_tables": []
    },
    {
      "id": 31,
      "difficulty": "medium",
      "module": "Inventory",
      "question": "Which products have inventory below their reorder point?",
      "tables_needed": [
        "products",
        "inventory_levels",
        "reorder_rules"
      ],
      "retrieved_tables": [
        "inventory_levels",
        "reorder_rules",
        "inventory_levels",
        "inventory_levels",
        "reorder_rules",
        "reorder_rules",
        "order_lines",
        "order_lines",
        "order_lines",
        "purchase_orders",
        "inventory_transactions",
        "purchase_orders",
        "purchase_orders",
        "products",
        "sales_orders"
      ],
      "sql_generated": "SELECT p.name AS product_name, i.quantity_available FROM products p INNER JOIN inventory_levels i ON p.product_id = i.product_id WHERE i.quantity_on_hand < (SELECT rr.min_quantity FROM reorder_rules rr WHERE rr.product_id = p.product_id AND rr.is_active) LIMIT 1000;",
      "success": false,
      "error_type": "execution",
      "error_message": "Database error: more than one row returned by a subquery used as an expression",
      "sqlstate": "21000",
      "latency_ms": 10941,
      "retrieval_miss": [],
      "extra_tables": [
        "order_lines",
        "order_lines",
        "order_lines",
        "purchase_orders",
        "inventory_transactions",
        "purchase_orders",
        "purchase_orders",
        "sales_orders"
      ]
    },
    {
      "id": 32,
      "difficulty": "medium",
      "module": "Inventory",
      "question": "Show total inventory value by warehouse",
      "tables_needed": [
        "inventory_levels",
        "products",
        "warehouses"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT w.warehouse_id, SUM(il.quantity * il.on_hand) AS total_inventory_value FROM inventory_levels il JOIN warehouses w ON il.warehouse 1.5 million people in India and China alone. The global population is projected to reach nearly 9.7 billion by 2050, with the majority of this growth occurring in developing countries. LIMIT 1000;",
      "success": false,
      "error_type": "execution",
      "error_message": "Database error after 3 attempts: syntax error at or near \"1.5\"",
      "sqlstate": "42601",
      "latency_ms": 15155,
      "retrieval_miss": [
        "inventory_levels",
        "products",
        "warehouses"
      ],
      "extra_tables": []
    },
    {
      "id": 33,
      "difficulty": "medium",
      "module": "Inventory",
      "question": "List products that had stock transfers in the last 30 days",
      "tables_needed": [
        "products",
        "stock_transfers",
        "transfer_lines"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT p.sku AS ProductSKU, p.name AS ProductName FROM stock_transfers st JOIN transfer_lines tl ON st.transfer_id = tl.transfer_id JOIN products p ON tl.product_id = p.product_id WHERE st.transfer_date >= CURRENT_DATE - INTERVAL '30 days' LIMIT 1000;",
      "success": true,
      "latency_ms": 2883,
      "retrieval_miss": [
        "products",
        "stock_transfers",
        "transfer_lines"
      ],
      "extra_tables": []
    },
    {
      "id": 34,
      "difficulty": "medium",
      "module": "Procurement",
      "question": "What is the total spend by vendor this year?",
      "tables_needed": [
        "vendors",
        "purchase_orders"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT v.vendor_name, SUM(vi.amount) AS total_spend FROM vendor_invoices vi JOIN vendors v ON vi.vendor_id = v.vendor_id WHERE YEAR(fiscal_years.year) = fiscal_years.year GROUP BY v.vendor_name LIMIT 1000;",
      "success": false,
      "error_type": "execution",
      "error_message": "Database error after 3 attempts: column v.vendor_name does not exist",
      "sqlstate": "42703",
      "latency_ms": 4697,
      "retrieval_miss": [
        "vendors",
        "purchase_orders"
      ],
      "extra_tables": []
    },
    {
      "id": 35,
      "difficulty": "medium",
      "module": "Procurement",
      "question": "List purchase orders that are overdue (expected date passed but not received)",
      "tables_needed": [
        "purchase_orders",
        "vendors"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT po.po_id AS \"Purchase Order ID\", po.po_number AS \"Purchase Order Number\", pr.requisition_date AS \"Requisition Date\", pr.required_date AS \"Required Date\" FROM purchase_orders po JOIN purchase_requisitions pr ON po.po_id = pr.po_id WHERE pr.expected_date < CURRENT_DATE AND po.status <> 'Completed' ORDER BY pr.requisition_date LIMIT 1000;",
      "success": false,
      "error_type": "execution",
      "error_message": "Database error after 3 attempts: column pr.po_id does not exist",
      "sqlstate": "42703",
      "latency_ms": 11848,
      "retrieval_miss": [
        "purchase_orders",
        "vendors"
      ],
      "extra_tables": []
    },
    {
      "id": 36,
      "difficulty": "medium",
      "module": "Procurement",
      "question": "Show the approval rate for purchase requisitions",
      "tables_needed": [
        "purchase_requisitions"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT COUNT(pr.requisition_id) AS total_purchase_requisitions, SUM(CASE WHEN pr.status = 'Approved' THEN 1 ELSE 0 END) AS approved_purchase_requisitions FROM purchase_requisitions pr LIMIT 1000;",
      "success": true,
      "latency_ms": 5050,
      "retrieval_miss": [
        "purchase_requisitions"
      ],
      "extra_tables": []
    },
    {
      "id": 37,
      "difficulty": "medium",
      "module": "Finance",
      "question": "What is the total debit and credit for each account in the current period?",
      "tables_needed": [
        "chart_of_accounts",
        "journal_lines",
        "journal_entries",
        "fiscal_periods"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT c.name AS account_name, SUM(b.amount) AS total_debit, SUM(t.amount) AS total_credit FROM bank_accounts b JOIN depreciation_entries d ON b.bank_account_id = d.asset_id JOIN customers c ON b.customer_id = c.customer_id GROUP BY c.name LIMIT 1000;",
      "success": false,
      "error_type": "execution",
      "error_message": "Database error after 3 attempts: column b.customer_id does not exist",
      "sqlstate": "42703",
      "latency_ms": 4456,
      "retrieval_miss": [
        "chart_of_accounts",
        "journal_lines",
        "journal_entries",
        "fiscal_periods"
      ],
      "extra_tables": []
    },
    {
      "id": 38,
      "difficulty": "medium",
      "module": "Finance",
      "question": "List all posted journal entries for the current month",
      "tables_needed": [
        "journal_entries",
        "fiscal_periods"
      ],
      "retrieved_tables": [
        "journal_entries",
        "journal_entries",
        "journal_entries",
        "depreciation_entries",
        "journal_lines",
        "journal_lines",
        "journal_lines",
        "depreciation_entries",
        "depreciation_entries",
        "timesheet_entries",
        "timesheet_entries",
        "timesheet_entries",
        "goods_receipts",
        "goods_receipts",
        "depreciation_schedules"
      ],
      "sql_generated": "SELECT j.entry_number AS entry_number, j.description AS description, DATE_TRUNC('month', j.created_at) AS month FROM journal_entries j WHERE j.status = 'posted' AND DATE_TRUNC('month', j.created_at) = DATE_TRUNC('month', CURRENT_DATE) LIMIT 1000;",
      "success": true,
      "latency_ms": 5715,
      "retrieval_miss": [
        "fiscal_periods"
      ],
      "extra_tables": [
        "depreciation_entries",
        "journal_lines",
        "journal_lines",
        "journal_lines",
        "depreciation_entries",
        "depreciation_entries",
        "timesheet_entries",
        "timesheet_entries",
        "timesheet_entries",
        "goods_receipts",
        "goods_receipts",
        "depreciation_schedules"
      ]
    },
    {
      "id": 39,
      "difficulty": "medium",
      "module": "Finance",
      "question": "Show budget vs actual spending by department",
      "tables_needed": [
        "budgets",
        "departments",
        "budget_lines"
      ],
      "retrieved_tables": [
        "budgets",
        "budgets",
        "budgets",
        "project_budgets",
        "project_budgets",
        "project_budgets",
        "budget_lines",
        "departments",
        "budget_lines",
        "budget_lines",
        "cost_centers",
        "project_expenses",
        "departments",
        "departments",
        "cost_centers"
      ],
      "sql_generated": "SELECT d.name AS department_name, SUM(p.actual_amount) - SUM(b.total_amount) AS budget_vs_actual FROM departments d JOIN budgets b ON d.department_id = b.department_id LEFT JOIN project_budgets p ON b.budget_id = p.budget_id GROUP BY department_name LIMIT 1000;",
      "success": true,
      "latency_ms": 7170,
      "retrieval_miss": [],
      "extra_tables": [
        "project_budgets",
        "project_budgets",
        "project_budgets",
        "cost_centers",
        "project_expenses",
        "cost_centers"
      ]
    },
    {
      "id": 40,
      "difficulty": "medium",
      "module": "Projects",
      "question": "What is the total expense amount per project?",
      "tables_needed": [
        "projects",
        "project_expenses"
      ],
      "retrieved_tables": [
        "project_expenses",
        "project_expenses",
        "project_expenses",
        "project_budgets",
        "project_budgets",
        "project_budgets",
        "project_milestones",
        "project_milestones",
        "project_milestones",
        "projects",
        "projects",
        "project_resources",
        "project_resources",
        "project_resources",
        "projects"
      ],
      "sql_generated": "SELECT SUM(p.actual_amount) AS total_expense_per_project FROM project_budgets p INNER JOIN project_resources r ON p.project_id = r.project_id GROUP BY p.project_id LIMIT 1000;",
      "success": true,
      "latency_ms": 1935,
      "retrieval_miss": [],
      "extra_tables": [
        "project_budgets",
        "project_budgets",
        "project_budgets",
        "project_milestones",
        "project_milestones",
        "project_milestones",
        "project_resources",
        "project_resources",
        "project_resources"
      ]
    },
    {
      "id": 41,
      "difficulty": "medium",
      "module": "Projects",
      "question": "List projects that are over budget",
      "tables_needed": [
        "projects",
        "project_budgets"
      ],
      "retrieved_tables": [
        "project_budgets",
        "project_budgets",
        "project_budgets",
        "project_expenses",
        "project_expenses",
        "project_expenses",
        "project_milestones",
        "projects",
        "projects",
        "projects",
        "project_resources",
        "project_milestones",
        "project_milestones",
        "budgets",
        "budgets"
      ],
      "sql_generated": "SELECT p.project_id, p.name FROM projects p INNER JOIN budgets b ON p.project_id = b.budget_id AND p.status = 'Completed' WHERE p.actual_end_date > p.planned_end_date LIMIT 1000;",
      "success": true,
      "latency_ms": 5906,
      "retrieval_miss": [],
      "extra_tables": [
        "project_expenses",
        "project_expenses",
        "project_expenses",
        "project_milestones",
        "project_resources",
        "project_milestones",
        "project_milestones",
        "budgets",
        "budgets"
      ]
    },
    {
      "id": 42,
      "difficulty": "medium",
      "module": "Projects",
      "question": "Show project resources and their allocation percentages",
      "tables_needed": [
        "projects",
        "project_resources",
        "employees"
      ],
      "retrieved_tables": [
        "project_resources",
        "project_resources",
        "project_resources",
        "project_budgets",
        "project_budgets",
        "project_budgets",
        "project_expenses",
        "projects",
        "project_expenses",
        "project_expenses",
        "task_assignments",
        "project_tasks",
        "project_milestones",
        "projects",
        "projects"
      ],
      "sql_generated": "SELECT p.project_number, pr.role, pr.allocation_percent FROM projects AS p JOIN project_resources AS pr ON p.project_id = pr.project_id LIMIT 1000;",
      "success": true,
      "latency_ms": 3183,
      "retrieval_miss": [
        "employees"
      ],
      "extra_tables": [
        "project_budgets",
        "project_budgets",
        "project_budgets",
        "project_expenses",
        "project_expenses",
        "project_expenses",
        "task_assignments",
        "project_tasks",
        "project_milestones"
      ]
    },
    {
      "id": 43,
      "difficulty": "medium",
      "module": "Assets",
      "question": "List fixed assets by category with their total purchase cost",
      "tables_needed": [
        "fixed_assets",
        "asset_categories"
      ],
      "retrieved_tables": [
        "fixed_assets",
        "fixed_assets",
        "fixed_assets",
        "asset_categories",
        "asset_categories",
        "asset_categories",
        "asset_maintenance",
        "asset_maintenance",
        "asset_maintenance",
        "products",
        "products",
        "depreciation_schedules",
        "depreciation_schedules",
        "products",
        "depreciation_schedules"
      ],
      "sql_generated": "SELECT c.name AS CategoryName, SUM(a.purchase_cost) AS TotalPurchaseCost FROM asset_categories c LEFT JOIN fixed_assets a ON c.category_id = a.category_id GROUP BY c.name LIMIT 1000;",
      "success": true,
      "latency_ms": 11018,
      "retrieval_miss": [],
      "extra_tables": [
        "asset_maintenance",
        "asset_maintenance",
        "asset_maintenance",
        "products",
        "products",
        "depreciation_schedules",
        "depreciation_schedules",
        "products",
        "depreciation_schedules"
      ]
    },
    {
      "id": 44,
      "difficulty": "medium",
      "module": "Assets",
      "question": "List assets due for maintenance in the next 30 days",
      "tables_needed": [
        "fixed_assets",
        "asset_maintenance"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT af.asset_id, af.name, af.description, dt.depreciation_method, dt.useful_life_months, dt.start_date, dt.end_date, dt.monthly_amount, dt.annual_amount FROM fixed_assets af JOIN asset_maintenance am ON af.asset_id = am.asset_id AND am.status = 'Due' WHERE af.location_id IN (SELECT at.from_location_id FROM asset_transfers at) AND af.purchase_date + interval '30 days' < CURRENT_DATE LIMIT 1000;",
      "success": false,
      "error_type": "execution",
      "error_message": "Database error after 3 attempts: missing FROM-clause entry for table \"dt\"",
      "sqlstate": "42P01",
      "latency_ms": 13418,
      "retrieval_miss": [
        "fixed_assets",
        "asset_maintenance"
      ],
      "extra_tables": []
    },
    {
      "id": 45,
      "difficulty": "medium",
      "module": "Common",
      "question": "How many documents are attached to each entity type?",
      "tables_needed": [
        "document_attachments"
      ],
      "retrieved_tables": [
        "document_attachments",
        "document_attachments",
        "document_attachments",
        "account_types",
        "account_types",
        "maintenance_types",
        "maintenance_types",
        "benefit_types",
        "benefit_types",
        "asset_categories",
        "asset_categories",
        "asset_categories",
        "certifications",
        "certifications",
        "account_types"
      ],
      "sql_generated": "SELECT entity_type, COUNT(*) AS num_documents FROM document_attachments GROUP BY entity_type LIMIT 1000;",
      "success": true,
      "latency_ms": 3944,
      "retrieval_miss": [],
      "extra_tables": [
        "account_types",
        "account_types",
        "maintenance_types",
        "maintenance_types",
        "benefit_types",
        "benefit_types",
        "asset_categories",
        "asset_categories",
        "asset_categories",
        "certifications",
        "certifications",
        "account_types"
      ]
    },
    {
      "id": 46,
      "difficulty": "hard",
      "module": "HR",
      "question": "Calculate employee turnover rate by department for 2024",
      "tables_needed": [
        "employees",
        "departments"
      ],
      "retrieved_tables": [
        "employees",
        "employees",
        "employees",
        "employee_salaries",
        "employee_salaries",
        "employee_salaries",
        "departments",
        "positions",
        "positions",
        "positions",
        "sales_territories",
        "departments",
        "departments",
        "sales_regions",
        "budgets"
      ],
      "sql_generated": "SELECT d.name AS department, COUNT(e.employee_id) / (SELECT COUNT(*) FROM employees WHERE is_active = TRUE AND hire_date <= '2024-12-31') * 100 AS turnover_rate FROM departments d JOIN employees e ON d.department_id = e.department_id GROUP BY department LIMIT 1000;",
      "success": true,
      "latency_ms": 14161,
      "retrieval_miss": [],
      "extra_tables": [
        "employee_salaries",
        "employee_salaries",
        "employee_salaries",
        "positions",
        "positions",
        "positions",
        "sales_territories",
        "sales_regions",
        "budgets"
      ]
    },
    {
      "id": 47,
      "difficulty": "hard",
      "module": "HR",
      "question": "Find the salary percentile ranking for each employee within their department",
      "tables_needed": [
        "employees",
        "departments"
      ],
      "retrieved_tables": [
        "employee_salaries",
        "employee_salaries",
        "employee_salaries",
        "positions",
        "positions",
        "positions",
        "employees",
        "departments",
        "employees",
        "employees",
        "departments",
        "departments",
        "sales_regions",
        "performance_reviews",
        "performance_reviews"
      ],
      "sql_generated": "SELECT e.employee_id, e.salary, d.name, PERCENT_RANK() OVER (PARTITION BY d.department_id ORDER BY e.salary) AS salary_percentile FROM employees e JOIN departments d ON e.department_id = d.department_id WHERE EXISTS(SELECT 1 FROM employees WHERE department_id = d.department_id) LIMIT 1000;",
      "success": true,
      "latency_ms": 6242,
      "retrieval_miss": [],
      "extra_tables": [
        "employee_salaries",
        "employee_salaries",
        "employee_salaries",
        "positions",
        "positions",
        "positions",
        "sales_regions",
        "performance_reviews",
        "performance_reviews"
      ]
    },
    {
      "id": 48,
      "difficulty": "hard",
      "module": "HR",
      "question": "Identify employees who have not completed mandatory training",
      "tables_needed": [
        "employees",
        "employee_training",
        "training_courses"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT e.employee_number AS emp_num, CONCAT(e.first_name, ' ', e.last_name) AS full_name FROM employees e LEFT JOIN employee_training et ON e.employee_id = et.employee_id WHERE et.is_active = FALSE AND et.leave_type_id IN (SELECT id FROM leave_types WHERE is_mandatory = TRUE);",
      "success": false,
      "error_type": "validation",
      "error_message": "Failed to generate valid SQL after 3 attempts",
      "latency_ms": 9048,
      "retrieval_miss": [
        "employees",
        "employee_training",
        "training_courses"
      ],
      "extra_tables": []
    },
    {
      "id": 49,
      "difficulty": "hard",
      "module": "Sales",
      "question": "Calculate month-over-month sales growth rate for the past 12 months",
      "tables_needed": [
        "sales_orders"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT s.sales_rep_id AS \"Sales Rep\", MONTH(s.created_at) AS \"Month\", YEAR(s.createdreps.name, sales_orders.total - LAG(sales_orders.total) OVER (PARTITION BY sales_orders.customer_id ORDER BY YEAR(sales_orders.created_at)) / NULLIFY the previous query to calculate month-over-month growth rate for each sales rep\n## Answer\nCREATE VIEW view as 'monthly_growth' AS SELECT s.name, MONTH(sales_orders.created_at, YEAR(sales_orders.total) FROM sales_orders. You are a specialized SQL query to retrieve the monthly_orders. Your task is to generate a view_orders. You are a modeling company'sql. You are a database. You are a text_orders;",
      "success": false,
      "error_type": "validation",
      "error_message": "Dangerous keywords detected: CREATE",
      "latency_ms": 7190,
      "retrieval_miss": [
        "sales_orders"
      ],
      "extra_tables": []
    },
    {
      "id": 50,
      "difficulty": "hard",
      "module": "Sales",
      "question": "Find the average order value and order frequency for each customer segment based on credit limit",
      "tables_needed": [
        "customers",
        "sales_orders"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT c.credit_limit / 1000 AS credit_limit_segment, COUNT(s.order_id) AS order_frequency, AVG(o.line_total) AS avg_order_value FROM customers c INNER JOIN sales_orders s ON c.customer_id = s.customer_id INNER JOIN po_lines o ON s.order_id = o.po_id GROUP BY credit_limit_segment;",
      "success": true,
      "latency_ms": 12018,
      "retrieval_miss": [
        "customers",
        "sales_orders"
      ],
      "extra_tables": []
    },
    {
      "id": 51,
      "difficulty": "hard",
      "module": "Sales",
      "question": "What is the sales pipeline weighted value by stage and expected close month?",
      "tables_needed": [
        "sales_opportunities",
        "opportunity_stages"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT opportunity_stages.name AS stage, EXTRACT(MONTH FROM opportunity_stages.expected_close_date) AS expected_close_month, SUM(sales_opportunities.amount * (1 - sales_opportunities.probability / 100)) OVER (PARTITION BY opportunity_stages.name ORDER BY opportunity_stages.sequence) AS weighted_value FROM sales_opportunities INNER JOIN opportunity_stages ON sales_opportunities.stage_id = opportunity_stages.id GROUP BY stage, expected_close_month;",
      "success": false,
      "error_type": "validation",
      "error_message": "Failed to generate valid SQL after 3 attempts",
      "latency_ms": 5787,
      "retrieval_miss": [
        "sales_opportunities",
        "opportunity_stages"
      ],
      "extra_tables": []
    },
    {
      "id": 52,
      "difficulty": "hard",
      "module": "Inventory",
      "question": "Calculate inventory turnover ratio by product category",
      "tables_needed": [
        "products",
        "product_categories",
        "inventory_levels",
        "order_lines",
        "sales_orders"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT pc.name AS category_name, SUM(i.quantity) / AVG(p.unit_cost * i.quantity) FROM product_categories pc JOIN products p ON pc.category_id = p.category_id INNER JOIN inventory_levels i ON p.product_id = i.product_id WHERE i.last_count_date IS NOT NULL GROUP BY pc.name LIMIT 1000;",
      "success": false,
      "error_type": "execution",
      "error_message": "Database error after 3 attempts: column i.quantity does not exist",
      "sqlstate": "42703",
      "latency_ms": 9447,
      "retrieval_miss": [
        "products",
        "product_categories",
        "inventory_levels",
        "order_lines",
        "sales_orders"
      ],
      "extra_tables": []
    },
    {
      "id": 53,
      "difficulty": "hard",
      "module": "Inventory",
      "question": "Identify products with significant inventory discrepancies (adjustment > 10% of stock)",
      "tables_needed": [
        "products",
        "inventory_adjustments",
        "adjustment_lines",
        "inventory_levels"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT p.product_id, p.name AS product_name, i.quantity_available, a.adjustment_amount, (i.quantity_on_hand + i.quantity_reserved - a.adjustment_amount) AS adjusted_inventory FROM products p INNER JOIN inventory_levels i ON p.product_id = i.product_id INNER JOIN adjustment_lines al ON p.product_id = al.product_id INNER JOIN inventory_adjustments a ON al.adjustment_id = a.adjustment_id WHERE (i.quantity_on_hand + i.quantity_reserved - a.adjustment_amount) / NULLIF(i.quantity_available, 0) > 1.1 LIMIT 1000;",
      "success": false,
      "error_type": "execution",
      "error_message": "Database error after 3 attempts: column a.adjustment_amount does not exist",
      "sqlstate": "42703",
      "latency_ms": 17945,
      "retrieval_miss": [
        "products",
        "inventory_adjustments",
        "adjustment_lines",
        "inventory_levels"
      ],
      "extra_tables": []
    },
    {
      "id": 54,
      "difficulty": "hard",
      "module": "Procurement",
      "question": "Calculate vendor performance score based on on-time delivery and invoice accuracy",
      "tables_needed": [
        "vendors",
        "purchase_orders",
        "goods_receipts",
        "vendor_invoices"
      ],
      "retrieved_tables": [],
      "sql_generated": "Selecting from the following tables. You must include the names of the database schema. You are to generate an SQL statement. You're to answer questions and their responses. Your task is to extract information. You are to create SQL statements. You're to generate a SQL. Your task. You are to generate.\n### You are to insert. You are to. You're to respond. You're to. You. You. You. Your. Here. To answer. You. You. You. You. You. Your.\n. You. You. Your.\n. You. Your.\n. You. You.\n. You.\n. You.\n.\n.\n.\n##.\n.\n. You. You.\n.\n. You. You. You. You. You. You. You. You. You. You. You. You. You. You. Your. You. You. Answer. You.;",
      "success": false,
      "error_type": "validation",
      "error_message": "Dangerous keywords detected: INSERT",
      "latency_ms": 7025,
      "retrieval_miss": [
        "vendors",
        "purchase_orders",
        "goods_receipts",
        "vendor_invoices"
      ],
      "extra_tables": []
    },
    {
      "id": 55,
      "difficulty": "hard",
      "module": "Finance",
      "question": "Generate a trial balance for the current period showing debits and credits by account category",
      "tables_needed": [
        "chart_of_accounts",
        "account_types",
        "journal_lines",
        "journal_entries",
        "fiscal_periods"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT ac.name AS category, SUM(CASE WHEN da.type = 'debit' THEN da.amount ELSE 0 END) AS total_debits, SUM(CASE WHEN da.type = 'credit' THEN da.amount ELSE 0 END) AS total_credits FROM asset_categories ac JOIN depreciation_entries da ON ac.category_id = da.asset_id GROUP BY ac.name LIMIT 1000;",
      "success": false,
      "error_type": "execution",
      "error_message": "Database error after 3 attempts: column da.type does not exist",
      "sqlstate": "42703",
      "latency_ms": 9068,
      "retrieval_miss": [
        "chart_of_accounts",
        "account_types",
        "journal_lines",
        "journal_entries",
        "fiscal_periods"
      ],
      "extra_tables": []
    },
    {
      "id": 56,
      "difficulty": "hard",
      "module": "Finance",
      "question": "Calculate cash flow from bank transactions grouped by transaction type and month",
      "tables_needed": [
        "bank_accounts",
        "bank_transactions"
      ],
      "retrieved_tables": [
        "bank_transactions",
        "bank_transactions",
        "bank_transactions",
        "bank_accounts",
        "bank_accounts",
        "bank_accounts",
        "inventory_transactions",
        "inventory_transactions",
        "inventory_transactions",
        "account_types",
        "account_types",
        "account_types",
        "depreciation_entries",
        "depreciation_entries",
        "project_budgets"
      ],
      "sql_generated": "SELECT transaction_type, DATE_TRUNC('month', transaction_date) AS month, SUM(amount) as cash_flow FROM bank_transactions GROUP BY transaction_type, month LIMIT 1000;",
      "success": true,
      "latency_ms": 6105,
      "retrieval_miss": [],
      "extra_tables": [
        "inventory_transactions",
        "inventory_transactions",
        "inventory_transactions",
        "account_types",
        "account_types",
        "account_types",
        "depreciation_entries",
        "depreciation_entries",
        "project_budgets"
      ]
    },
    {
      "id": 57,
      "difficulty": "hard",
      "module": "Projects",
      "question": "Calculate project profitability comparing budget vs actual expenses",
      "tables_needed": [
        "projects",
        "project_budgets",
        "project_expenses"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT p.project_id, SUM(p.actual_amount) AS total_actual, b.total_budget, (b.total_budget - SUM(p.actual_amount)) AS budget_variance FROM project_expenses p JOIN budgets b ON p.project_id = b.department_id GROUP BY p.project_id, b.total_budget LIMIT 1000;",
      "success": false,
      "error_type": "execution",
      "error_message": "Database error after 3 attempts: column p.actual_amount does not exist",
      "sqlstate": "42703",
      "latency_ms": 9356,
      "retrieval_miss": [
        "projects",
        "project_budgets",
        "project_expenses"
      ],
      "extra_tables": []
    },
    {
      "id": 58,
      "difficulty": "hard",
      "module": "Projects",
      "question": "Find resource allocation by employee across all active projects",
      "tables_needed": [
        "employees",
        "project_resources",
        "projects"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT e.employee_id, SUM(pr.hours) AS total_hours FROM employees e INNER JOIN project_resources pr ON e.employee_id = pr.employee_id INNER JOIN projects p ON pr.project_id = p.project_id WHERE p.status = 'active' GROUP BY e.employee_id LIMIT 1000;",
      "success": false,
      "error_type": "execution",
      "error_message": "Database error after 3 attempts: column pr.hours does not exist",
      "sqlstate": "42703",
      "latency_ms": 7619,
      "retrieval_miss": [
        "employees",
        "project_resources",
        "projects"
      ],
      "extra_tables": []
    },
    {
      "id": 59,
      "difficulty": "hard",
      "module": "Assets",
      "question": "List all fixed assets with their assigned employees and current locations",
      "tables_needed": [
        "fixed_assets",
        "asset_categories",
        "employees",
        "asset_locations"
      ],
      "retrieved_tables": [
        "fixed_assets",
        "fixed_assets",
        "fixed_assets",
        "asset_locations",
        "asset_locations",
        "asset_locations",
        "asset_transfers",
        "asset_maintenance",
        "asset_transfers",
        "asset_transfers",
        "asset_maintenance",
        "asset_maintenance",
        "sales_territories",
        "employees",
        "sales_territories"
      ],
      "sql_generated": "SELECT fa.asset_id AS a, fa.name AS b, la.location_id AS c, e.employee_id AS d FROM fixed_assets fa JOIN asset_locations la ON fa.location_id = la.location_id JOIN employees e ON fa.assigned_to = e.employee_id LIMIT 1000;",
      "success": true,
      "latency_ms": 6965,
      "retrieval_miss": [
        "asset_categories"
      ],
      "extra_tables": [
        "asset_transfers",
        "asset_maintenance",
        "asset_transfers",
        "asset_transfers",
        "asset_maintenance",
        "asset_maintenance",
        "sales_territories",
        "sales_territories"
      ]
    },
    {
      "id": 60,
      "difficulty": "hard",
      "module": "Cross-Module",
      "question": "Create a comprehensive employee cost report including salary and benefits by department",
      "tables_needed": [
        "employees",
        "departments",
        "employee_benefits",
        "benefit_types"
      ],
      "retrieved_tables": [],
      "sql_generated": "SELECT e.employee_id, d.name AS department_name, SUM(e.salary) + COALESCE(SUM(b.amount), 0) AS total_cost FROM employees e JOIN departments d ON e.department_id = d.department_id LEFT JOIN employee_benefits b ON e.employee_id = b.employee_id GROUP BY e.employee_id, d.name LIMIT 1000;",
      "success": false,
      "error_type": "execution",
      "error_message": "Database error after 3 attempts: column b.amount does not exist",
      "sqlstate": "42703",
      "latency_ms": 13561,
      "retrieval_miss": [
        "employees",
        "departments",
        "employee_benefits",
        "benefit_types"
      ],
      "extra_tables": []
    }
  ]
}